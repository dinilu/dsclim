<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Learn how to load climate data from the three sources (i.e. TraCE21ka, UERRA, and CMIP5) to R in climate4r format
">
<title>2. Load source data • dsclim</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="2. Load source data">
<meta property="og:description" content="Learn how to load climate data from the three sources (i.e. TraCE21ka, UERRA, and CMIP5) to R in climate4r format
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dsclim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a1_Data_downloading_and_preprocessing.html">1. Data downloading and preprocessing</a>
    <a class="dropdown-item" href="../articles/a2_Load_source_data.html">2. Load source data</a>
    <a class="dropdown-item" href="../articles/a3_Downscale_with_Cross-validation.html">3. Downscaling with crossvalidation</a>
    <a class="dropdown-item" href="../articles/a4_Downscale_climate_data.html">4. Downscaling climate data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dinilu/dsclim/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>2. Load source data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dinilu/dsclim/blob/HEAD/vignettes/a2_Load_source_data.Rmd" class="external-link"><code>vignettes/a2_Load_source_data.Rmd</code></a></small>
      <div class="d-none name"><code>a2_Load_source_data.Rmd</code></div>
    </div>

    
    
<div class="alert alert-warning" role="alert">
This vignettes require climate data from three different sources:
TraCE21ka, UERRA, and CMIP5. Please follow
<code><a href="../articles/a1_Data_downloading_and_preprocessing.html">vignette("a1_Data_downloading_and_preprocessing")</a></code> before
going on.
</div>
<div class="section level2">
<h2 id="trace21ka-data">TraCE21ka data<a class="anchor" aria-label="anchor" href="#trace21ka-data"></a>
</h2>
<p>Original TraCE21ka data are in NetCDF format. However, they have
several characteristics that makes not straightforward to import them
using function from the <a href="https://github.com/SantanderMetGroup/loadeR/wiki" class="external-link">loadeR</a> package. Hence, we have
developed a set of wrapper functions to import those data into R with
the <code>climate4r</code> format. More specifically, to load the
TraCE21ka data for the historical period, we use the
<code><a href="../reference/loadTrace.html">dsclim::loadHistoricalTraceGrid()</a></code> function. This function
requires the file (including the path to the file) and the variable name
(as it is specified in the data dictionary for standardization).
Optionally, the spatial coverage can be controlled, specifying an extent
by the longitudinal and latitudinal extents. In this tutorial we use the
same extent used to create our dsclim data for the Western Mediterranean
region.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dinilu/dsclim" class="external-link">dsclim</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">trace.lon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="va">trace.lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<div class="section level3 tabset">
<h3 class="tabset" id="loading-trace21ka-data">Loading TraCE21ka data<a class="anchor" aria-label="anchor" href="#loading-trace21ka-data"></a>
</h3>
<p>The function also allow to specify the starting and ending year of
the desired period. If not specified, it uses the period 1961 to 1990,
both years included.</p>
<p>Once the data are loaded, we used the
<code><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">transformeR::climatology()</a></code> function to calculate the
average value of the variable for the whole period (e.g. 1961-1990).
Finally, the <code>visualizeR::spatialPlot()</code> function to plot the
resulting map.</p>
<p>Select a variable:</p>










<ul class="nav nav-tabs" id="loading-trace21ka-data" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#tsmx" id="tsmx-tab" type="button" role="tab" aria-controls="tsmx" aria-selected="true" class="active nav-link">TSMX</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#tsmn" id="tsmn-tab" type="button" role="tab" aria-controls="tsmn" aria-selected="false" class="nav-link">TSMN</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#ts" id="ts-tab" type="button" role="tab" aria-controls="ts" aria-selected="false" class="nav-link">TS</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#precc" id="precc-tab" type="button" role="tab" aria-controls="precc" aria-selected="false" class="nav-link">PRECC</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#relhum" id="relhum-tab" type="button" role="tab" aria-controls="relhum" aria-selected="false" class="nav-link">RELHUM</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#cldtot" id="cldtot-tab" type="button" role="tab" aria-controls="cldtot" aria-selected="false" class="nav-link">CLDTOT</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#ps" id="ps-tab" type="button" role="tab" aria-controls="ps" aria-selected="false" class="nav-link">PS</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#u" id="u-tab" type="button" role="tab" aria-controls="u" aria-selected="false" class="nav-link">U</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#v" id="v-tab" type="button" role="tab" aria-controls="v" aria-selected="false" class="nav-link">V</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#wss" id="wss-tab" type="button" role="tab" aria-controls="wss" aria-selected="false" class="nav-link">WSS</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="tsmx" role="tabpanel" aria-labelledby="tsmx-tab">

<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trace.tsmx</span> <span class="op">&lt;-</span> <span class="fu">dsclim</span><span class="fu">::</span><span class="fu"><a href="../reference/loadTrace.html">loadHistoricalTraceGrid</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/TSMX/trace.36.400BP-1990CE.cam2.h0.TSMX.2160101-2204012.nc"</span>, var <span class="op">=</span> <span class="st">"tasmax"</span>, lon_lim <span class="op">=</span> <span class="va">trace.lon</span>, lat_lim <span class="op">=</span> <span class="va">trace.lat</span>, years <span class="op">=</span> <span class="fl">1961</span><span class="op">:</span><span class="fl">1990</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">trace.tsmx</span><span class="op">)</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, rev.colors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_tsmx_trace.png" alt=""><p class="caption">Figure 1. Historical (1961-90) TraCE21ka data for
maximum surface temperature (tsmx).</p>
</div>
</div>
<div class="tab-pane" id="tsmn" role="tabpanel" aria-labelledby="tsmn-tab">

<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trace.tsmn</span> <span class="op">&lt;-</span> <span class="fu">dsclim</span><span class="fu">::</span><span class="fu"><a href="../reference/loadTrace.html">loadHistoricalTraceGrid</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/TSMN/trace.36.400BP-1990CE.cam2.h0.TSMN.2160101-2204012.nc"</span>, var <span class="op">=</span> <span class="st">"tasmin"</span>, lon_lim <span class="op">=</span> <span class="va">trace.lon</span>, lat_lim <span class="op">=</span> <span class="va">trace.lat</span>, years <span class="op">=</span> <span class="fl">1961</span><span class="op">:</span><span class="fl">1990</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">trace.tsmn</span><span class="op">)</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, rev.colors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_tsmn_trace.png" alt=""><p class="caption">Figure 1. Historical (1961-90) TraCE21ka data for
minimum surface temperature (tsmn).</p>
</div>
</div>
<div class="tab-pane" id="ts" role="tabpanel" aria-labelledby="ts-tab">

<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trace.ts</span> <span class="op">&lt;-</span> <span class="fu">dsclim</span><span class="fu">::</span><span class="fu"><a href="../reference/loadTrace.html">loadHistoricalTraceGrid</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/TS/trace.36.400BP-1990CE.cam2.h0.TS.2160101-2204012.nc"</span>, var <span class="op">=</span> <span class="st">"tas"</span>, lon_lim <span class="op">=</span> <span class="va">trace.lon</span>, lat_lim <span class="op">=</span> <span class="va">trace.lat</span>, years <span class="op">=</span> <span class="fl">1961</span><span class="op">:</span><span class="fl">1990</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">trace.ts</span><span class="op">)</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, rev.colors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_ts_trace.png" alt=""><p class="caption">Figure 1. Historical (1961-90) TraCE21ka data for
mean surface temperature (ts).</p>
</div>
</div>
<div class="tab-pane" id="precc" role="tabpanel" aria-labelledby="precc-tab">

<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trace.precc</span> <span class="op">&lt;-</span> <span class="fu">dsclim</span><span class="fu">::</span><span class="fu"><a href="../reference/loadTrace.html">loadHistoricalTraceGrid</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/PRECC/trace.36.400BP-1990CE.cam2.h0.PRECC.2160101-2204012.nc"</span>, var <span class="op">=</span> <span class="st">"pr"</span>, lon_lim <span class="op">=</span> <span class="va">trace.lon</span>, lat_lim <span class="op">=</span> <span class="va">trace.lat</span>, years <span class="op">=</span> <span class="fl">1961</span><span class="op">:</span><span class="fl">1990</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">trace.precc</span><span class="op">)</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_pr_trace.png" alt=""><p class="caption">Figure 1. Historical (1961-90) TraCE21ka data for
precipitation (pr).</p>
</div>
</div>
<div class="tab-pane" id="relhum" role="tabpanel" aria-labelledby="relhum-tab">

<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trace.relhum</span> <span class="op">&lt;-</span> <span class="fu">dsclim</span><span class="fu">::</span><span class="fu"><a href="../reference/loadTrace.html">loadHistoricalTraceGrid</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/RELHUM/trace.36.400BP-1990CE.cam2.h0.RELHUM.2160101-2204012.nc"</span>, var <span class="op">=</span> <span class="st">"hurs@992.5561"</span>, lon_lim <span class="op">=</span> <span class="va">trace.lon</span>, lat_lim <span class="op">=</span> <span class="va">trace.lat</span>, years <span class="op">=</span> <span class="fl">1961</span><span class="op">:</span><span class="fl">1990</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">trace.relhum</span><span class="op">)</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_rhum_trace.png" alt=""><p class="caption">Figure 1. Historical (1961-90) TraCE21ka data for
relative humidity (rhum).</p>
</div>
</div>
<div class="tab-pane" id="cldtot" role="tabpanel" aria-labelledby="cldtot-tab">

<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trace.cldtot</span> <span class="op">&lt;-</span> <span class="fu">dsclim</span><span class="fu">::</span><span class="fu"><a href="../reference/loadTrace.html">loadHistoricalTraceGrid</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/CLDTOT/trace.36.400BP-1990CE.cam2.h0.CLDTOT.2160101-2204012.nc"</span>, var <span class="op">=</span> <span class="st">"cld"</span>, lon_lim <span class="op">=</span> <span class="va">trace.lon</span>, lat_lim <span class="op">=</span> <span class="va">trace.lat</span>, years <span class="op">=</span> <span class="fl">1961</span><span class="op">:</span><span class="fl">1990</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">trace.cldtot</span><span class="op">)</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_cld_trace.png" alt=""><p class="caption">Figure 1. Historical (1961-90) TraCE21ka data for
cloudiness (cld).</p>
</div>
</div>
<div class="tab-pane" id="ps" role="tabpanel" aria-labelledby="ps-tab">

<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trace.ps</span> <span class="op">&lt;-</span> <span class="fu">dsclim</span><span class="fu">::</span><span class="fu"><a href="../reference/loadTrace.html">loadHistoricalTraceGrid</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/PS/trace.36.400BP-1990CE.cam2.h0.PS.2160101-2204012.nc"</span>, var <span class="op">=</span> <span class="st">"ps"</span>, lon_lim <span class="op">=</span> <span class="va">trace.lon</span>, lat_lim <span class="op">=</span> <span class="va">trace.lat</span>, years <span class="op">=</span> <span class="fl">1961</span><span class="op">:</span><span class="fl">1990</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">trace.ps</span><span class="op">)</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_ps_trace.png" alt=""><p class="caption">Figure 1. Historical (1961-90) TraCE21ka data for
surface pressure (ps).</p>
</div>
</div>
<div class="tab-pane" id="u" role="tabpanel" aria-labelledby="u-tab">

<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trace.u</span> <span class="op">&lt;-</span> <span class="fu">dsclim</span><span class="fu">::</span><span class="fu"><a href="../reference/loadTrace.html">loadHistoricalTraceGrid</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/U/trace.36.400BP-1990CE.cam2.h0.U.2160101-2204012.nc"</span>, var <span class="op">=</span> <span class="st">"u@992.5561"</span>, lon_lim <span class="op">=</span> <span class="va">trace.lon</span>, lat_lim <span class="op">=</span> <span class="va">trace.lat</span>, years <span class="op">=</span> <span class="fl">1961</span><span class="op">:</span><span class="fl">1990</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">trace.u</span><span class="op">)</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_u_trace.png" alt=""><p class="caption">Figure 1. Historical (1961-90) TraCE21ka data for
x-axis parallel wind component (u).</p>
</div>
</div>
<div class="tab-pane" id="v" role="tabpanel" aria-labelledby="v-tab">

<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trace.v</span> <span class="op">&lt;-</span> <span class="fu">dsclim</span><span class="fu">::</span><span class="fu"><a href="../reference/loadTrace.html">loadHistoricalTraceGrid</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/V/trace.36.400BP-1990CE.cam2.h0.V.2160101-2204012.nc"</span>, var <span class="op">=</span> <span class="st">"v@992.5561"</span>, lon_lim <span class="op">=</span> <span class="va">trace.lon</span>, lat_lim <span class="op">=</span> <span class="va">trace.lat</span>, years <span class="op">=</span> <span class="fl">1961</span><span class="op">:</span><span class="fl">1990</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">trace.v</span><span class="op">)</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_v_trace.png" alt=""><p class="caption">Figure 1. Historical (1961-90) TraCE21ka data for
y-axis parallel wind component (v).</p>
</div>
</div>
<div class="tab-pane" id="wss" role="tabpanel" aria-labelledby="wss-tab">

<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trace.wss</span> <span class="op">&lt;-</span> <span class="fu">dsclim</span><span class="fu">::</span><span class="fu"><a href="../reference/computeWindSpeed.html">computeWindSpeed</a></span><span class="op">(</span><span class="va">trace.u</span>, <span class="va">trace.v</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">trace.wss</span><span class="op">)</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_wss_trace.png" alt=""><p class="caption">Figure 1. Historical (1961-90) TraCE21ka data for
wind speed (wss).</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="make-multivariable-grid">Make multivariable grid<a class="anchor" aria-label="anchor" href="#make-multivariable-grid"></a>
</h3>
<p>The resulting objects can be combined in a multigrid object. This
will be required afterwards to use all those variables as predictors in
the downscaling process.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hist.trace</span> <span class="op">&lt;-</span> <span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/makeMultiGrid.html" class="external-link">makeMultiGrid</a></span><span class="op">(</span><span class="va">trace.tsmx</span>, <span class="va">trace.tsmn</span>, <span class="va">trace.ts</span>, <span class="va">trace.precc</span>, <span class="va">trace.relhum</span>, <span class="va">trace.cldtot</span>, <span class="va">trace.ps</span>, <span class="va">trace.wss</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">trace.tsmx</span>, <span class="va">trace.tsmn</span>, <span class="va">trace.ts</span>, <span class="va">trace.precc</span>, <span class="va">trace.relhum</span>, <span class="va">trace.cldtot</span>, <span class="va">trace.ps</span>, <span class="va">trace.wss</span>, <span class="va">trace.u</span>, <span class="va">trace.v</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">hist.trace</span><span class="op">)</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_combine_historical_trace.png" alt=""><p class="caption">Figure 2. Multigrid (all variables in the same
object) historical (1961-90) TraCE21ka data.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="uerra-historical-reanalisis-data">UERRA historical reanalisis data<a class="anchor" aria-label="anchor" href="#uerra-historical-reanalisis-data"></a>
</h2>
<p>The UERRA dataset were transformed after downloading to reproject
them (see code in the vignette
<code><a href="../articles/a1_Data_downloading_and_preprocessing.html">vignette("a1_Data_downloading_and_preprocessing")</a></code>). As
result of such transformation, we obtained NetCDF files that can be
directly imported in R using the <code><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData()</a></code> from the
<a href="https://github.com/SantanderMetGroup/loadeR/wiki" class="external-link">loadeR</a> package. This function also allow to specify a
geographical region to subset the loaded data.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uerra.lon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">11</span>, <span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">uerra.lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">28</span>, <span class="fl">44</span><span class="op">)</span></span></code></pre></div>
<div class="section level3 tabset">
<h3 class="tabset" id="loading-uerra-data">Loading UERRA data<a class="anchor" aria-label="anchor" href="#loading-uerra-data"></a>
</h3>
<p>Now, we load the tailored data of the UERRA dataset for the period
1961-1990. More specifically, we loaded the same variables that we were
interested to downscale. These grid objects were used as predictands in
the downscale process.</p>
<p>Select a variable</p>








<ul class="nav nav-tabs" id="loading-uerra-data" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#tasmin" id="tasmin-tab" type="button" role="tab" aria-controls="tasmin" aria-selected="true" class="active nav-link">TASMIN</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#tas" id="tas-tab" type="button" role="tab" aria-controls="tas" aria-selected="false" class="nav-link">TAS</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#tasmax" id="tasmax-tab" type="button" role="tab" aria-controls="tasmax" aria-selected="false" class="nav-link">TASMAX</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#pr" id="pr-tab" type="button" role="tab" aria-controls="pr" aria-selected="false" class="nav-link">PR</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#hurs" id="hurs-tab" type="button" role="tab" aria-controls="hurs" aria-selected="false" class="nav-link">HURS</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#ps-1" id="ps-1-tab" type="button" role="tab" aria-controls="ps-1" aria-selected="false" class="nav-link">PS</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#cld" id="cld-tab" type="button" role="tab" aria-controls="cld" aria-selected="false" class="nav-link">CLD</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#wss-1" id="wss-1-tab" type="button" role="tab" aria-controls="wss-1" aria-selected="false" class="nav-link">WSS</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="tasmin" role="tabpanel" aria-labelledby="tasmin-tab">

<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uerra.tasmin</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData</a></span><span class="op">(</span><span class="st">"Data/UERRA/UERRA-HARMONIE/2m_temperature/latlon/1961-90_2m_tmin.nc"</span>, var <span class="op">=</span> <span class="st">"tasmin"</span>, lonLim <span class="op">=</span> <span class="va">uerra.lon</span>, latLim <span class="op">=</span> <span class="va">uerra.lat</span>, dictionary <span class="op">=</span> <span class="st">"Data/UERRA/dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">uerra.tasmin</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"tasmin"</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, rev.colors <span class="op">=</span> <span class="cn">TRUE</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">40</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_tsmn_uerra.png" alt=""><p class="caption">Figure 3. Historical (1961-90) UERRA data for minimum
surface temperature (tasmin).</p>
</div>
</div>
<div class="tab-pane" id="tas" role="tabpanel" aria-labelledby="tas-tab">

<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uerra.tas</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData</a></span><span class="op">(</span><span class="st">"Data/UERRA/UERRA-HARMONIE/2m_temperature/latlon/1961-90_2m_temperature.nc"</span>, var <span class="op">=</span> <span class="st">"tas"</span>, lonLim <span class="op">=</span> <span class="va">uerra.lon</span>, latLim <span class="op">=</span> <span class="va">uerra.lat</span>, dictionary <span class="op">=</span> <span class="st">"Data/UERRA/dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">uerra.tas</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"tas"</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, rev.colors <span class="op">=</span> <span class="cn">TRUE</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">40</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_ts_uerra.png" alt=""><p class="caption">Figure 3. Historical (1961-90) UERRA data for mean
surface temperature (tas).</p>
</div>
</div>
<div class="tab-pane" id="tasmax" role="tabpanel" aria-labelledby="tasmax-tab">

<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uerra.tasmax</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData</a></span><span class="op">(</span><span class="st">"Data/UERRA/UERRA-HARMONIE/2m_temperature/latlon/1961-90_2m_tmax.nc"</span>, var <span class="op">=</span> <span class="st">"tasmax"</span>, lonLim <span class="op">=</span> <span class="va">uerra.lon</span>, latLim <span class="op">=</span> <span class="va">uerra.lat</span>, dictionary <span class="op">=</span> <span class="st">"Data/UERRA/dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">uerra.tasmax</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"tasmax"</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, rev.colors <span class="op">=</span> <span class="cn">TRUE</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">40</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_tsmx_uerra.png" alt=""><p class="caption">Figure 3. Historical (1961-90) UERRA data for maximum
surface temperature (tasmax).</p>
</div>
</div>
<div class="tab-pane" id="pr" role="tabpanel" aria-labelledby="pr-tab">

<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uerra.pr</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData</a></span><span class="op">(</span><span class="st">"Data/UERRA/MESCAN-SURFEX/total_precipitation/latlon/1961-90_total_precipitation.nc"</span>, var <span class="op">=</span> <span class="st">"pr"</span>, lonLim <span class="op">=</span> <span class="va">uerra.lon</span>, latLim <span class="op">=</span> <span class="va">uerra.lat</span>, dictionary <span class="op">=</span> <span class="st">"Data/UERRA/dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">uerra.pr</span> <span class="op">&lt;-</span> <span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/upscaleGrid.html" class="external-link">upscaleGrid</a></span><span class="op">(</span><span class="va">uerra.pr</span>, times <span class="op">=</span> <span class="fl">2</span>, aggr.fun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">uerra.pr</span> <span class="op">&lt;-</span> <span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/interpGrid.html" class="external-link">interpGrid</a></span><span class="op">(</span><span class="va">uerra.pr</span>, new.coordinates <span class="op">=</span> <span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/getGrid.html" class="external-link">getGrid</a></span><span class="op">(</span><span class="va">uerra.tas</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"bilinear"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">uerra.pr</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"pr"</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">400</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_pr_uerra.png" alt=""><p class="caption">Figure 3. Historical (1961-90) UERRA data for
precipitation (pr).</p>
</div>
</div>
<div class="tab-pane" id="hurs" role="tabpanel" aria-labelledby="hurs-tab">

<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uerra.hurs</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData</a></span><span class="op">(</span><span class="st">"Data/UERRA/UERRA-HARMONIE/2m_relative_humidity/latlon/1961-90_2m_relative_humidity.nc"</span>, var <span class="op">=</span> <span class="st">"hurs"</span>, lonLim <span class="op">=</span> <span class="va">uerra.lon</span>, latLim <span class="op">=</span> <span class="va">uerra.lat</span>, dictionary <span class="op">=</span> <span class="st">"Data/UERRA/dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">uerra.hurs</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"hurs"</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, rev.colors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_rhum_uerra.png" alt=""><p class="caption">Figure 3. Historical (1961-90) UERRA data for
relative humidity (rhum).</p>
</div>
</div>
<div class="tab-pane" id="ps-1" role="tabpanel" aria-labelledby="ps-1-tab">

<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uerra.ps</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData</a></span><span class="op">(</span><span class="st">"Data/UERRA/UERRA-HARMONIE/surface_pressure/latlon/1961-90_surface_pressure.nc"</span>, var <span class="op">=</span> <span class="st">"ps"</span>, lonLim <span class="op">=</span> <span class="va">uerra.lon</span>, latLim <span class="op">=</span> <span class="va">uerra.lat</span>, dictionary <span class="op">=</span> <span class="st">"Data/UERRA/dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">uerra.ps</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"ps"</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, rev.colors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_ps_uerra.png" alt=""><p class="caption">Figure 3. Historical (1961-90) UERRA data for surface
pressure (ps).</p>
</div>
</div>
<div class="tab-pane" id="cld" role="tabpanel" aria-labelledby="cld-tab">

<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uerra.cld</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData</a></span><span class="op">(</span><span class="st">"Data/UERRA/UERRA-HARMONIE/total_cloud_cover/latlon/1961-90_total_cloud_cover.nc"</span>, var <span class="op">=</span> <span class="st">"cld"</span>, lonLim <span class="op">=</span> <span class="va">uerra.lon</span>, latLim <span class="op">=</span> <span class="va">uerra.lat</span>, dictionary <span class="op">=</span> <span class="st">"Data/UERRA/dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">uerra.cld</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"cld"</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, rev.colors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_cld_uerra.png" alt=""><p class="caption">Figure 3. Historical (1961-90) UERRA data for
cloudiness (cld).</p>
</div>
</div>
<div class="tab-pane" id="wss-1" role="tabpanel" aria-labelledby="wss-1-tab">

<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uerra.wss</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData</a></span><span class="op">(</span><span class="st">"Data/UERRA/UERRA-HARMONIE/10m_wind_speed/latlon/1961-90_10m_wind_speed.nc"</span>, var <span class="op">=</span> <span class="st">"wss"</span>, lonLim <span class="op">=</span> <span class="va">uerra.lon</span>, latLim <span class="op">=</span> <span class="va">uerra.lat</span>, dictionary <span class="op">=</span> <span class="st">"Data/UERRA/dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">uerra.wss</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"wss"</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, rev.colors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_wss_uerra.png" alt=""><p class="caption">Figure 3. Historical (1961-90) UERRA data for wind
speed (wss).</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="fix-dates">Fix dates<a class="anchor" aria-label="anchor" href="#fix-dates"></a>
</h3>
<p>Dates from the UERRA files match the actual year and month, but are
interpreted as the central date of the month, rather than the whole
range of data. The <code><a href="../reference/modifyDates.html">modifyDates()</a></code> function from the
<a href="https://github.com/dinilu/dsclim" class="external-link">dsclim</a> package modify the dates and fix this small
issue.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uerra.tasmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modifyDates.html">modifyDates</a></span><span class="op">(</span><span class="va">uerra.tasmax</span><span class="op">)</span></span>
<span><span class="va">uerra.tasmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modifyDates.html">modifyDates</a></span><span class="op">(</span><span class="va">uerra.tasmin</span><span class="op">)</span></span>
<span><span class="va">uerra.tas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modifyDates.html">modifyDates</a></span><span class="op">(</span><span class="va">uerra.tas</span><span class="op">)</span></span>
<span><span class="va">uerra.pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modifyDates.html">modifyDates</a></span><span class="op">(</span><span class="va">uerra.pr</span><span class="op">)</span></span>
<span><span class="va">uerra.ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modifyDates.html">modifyDates</a></span><span class="op">(</span><span class="va">uerra.ps</span><span class="op">)</span></span>
<span><span class="va">uerra.hurs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modifyDates.html">modifyDates</a></span><span class="op">(</span><span class="va">uerra.hurs</span><span class="op">)</span></span>
<span><span class="va">uerra.cld</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modifyDates.html">modifyDates</a></span><span class="op">(</span><span class="va">uerra.cld</span><span class="op">)</span></span>
<span><span class="va">uerra.wss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modifyDates.html">modifyDates</a></span><span class="op">(</span><span class="va">uerra.wss</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="cmip5-future-data">CMIP5 future data<a class="anchor" aria-label="anchor" href="#cmip5-future-data"></a>
</h2>
<p>CMIP5 data can be directly loaded with the
<code><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData()</a></code> from the <a href="https://github.com/SantanderMetGroup/loadeR/wiki" class="external-link">loadeR</a> package.
Here, we used the same extent than for TraCE21ka dataset. For this
example, we are going to use the data set from the rcp2.6 and CESM1-CAM5
combination of representative concentration pathways and general
circulation model.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cmip5.lon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">11.25</span>, <span class="fl">12.50</span><span class="op">)</span></span>
<span><span class="va">cmip5.lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">27</span>, <span class="fl">45</span><span class="op">)</span></span></code></pre></div>
<div class="section level3 tabset">
<h3 class="tabset" id="loading-cmip5-data">Loading CMIP5 data<a class="anchor" aria-label="anchor" href="#loading-cmip5-data"></a>
</h3>
<p>Select a variable</p>








<ul class="nav nav-tabs" id="loading-cmip5-data" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#tasmin-1" id="tasmin-1-tab" type="button" role="tab" aria-controls="tasmin-1" aria-selected="true" class="active nav-link">TASMIN</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#tas-1" id="tas-1-tab" type="button" role="tab" aria-controls="tas-1" aria-selected="false" class="nav-link">TAS</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#tasmax-1" id="tasmax-1-tab" type="button" role="tab" aria-controls="tasmax-1" aria-selected="false" class="nav-link">TASMAX</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#pr-1" id="pr-1-tab" type="button" role="tab" aria-controls="pr-1" aria-selected="false" class="nav-link">PR</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#hurs-1" id="hurs-1-tab" type="button" role="tab" aria-controls="hurs-1" aria-selected="false" class="nav-link">HURS</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#ps-2" id="ps-2-tab" type="button" role="tab" aria-controls="ps-2" aria-selected="false" class="nav-link">PS</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#cld-1" id="cld-1-tab" type="button" role="tab" aria-controls="cld-1" aria-selected="false" class="nav-link">CLD</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#wss-2" id="wss-2-tab" type="button" role="tab" aria-controls="wss-2" aria-selected="false" class="nav-link">WSS</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="tasmin-1" role="tabpanel" aria-labelledby="tasmin-1-tab">

<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cmip.tasmin</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData</a></span><span class="op">(</span><span class="st">"Data/CMIP5/historical/CESM1-CAM5_historical/tasmin_Amon_CESM1-CAM5_historical_r1i1p1_185001-200512.nc"</span>, var <span class="op">=</span> <span class="st">"tasmin"</span>, lonLim <span class="op">=</span> <span class="va">cmip5.lon</span>, latLim <span class="op">=</span> <span class="va">cmip5.lat</span>, years <span class="op">=</span> <span class="fl">1961</span><span class="op">:</span><span class="fl">1990</span>, dictionary <span class="op">=</span> <span class="st">"Data/CMIP5/dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">cmip.tasmin</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"tasmin"</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, rev.colors <span class="op">=</span> <span class="cn">TRUE</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">40</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_tsmn_cmip5.png" alt=""><p class="caption">Figure 4. Historical (1961-90) CMIP5 data for minimum
surface temperature (tasmin).</p>
</div>
</div>
<div class="tab-pane" id="tas-1" role="tabpanel" aria-labelledby="tas-1-tab">

<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cmip.tas</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData</a></span><span class="op">(</span><span class="st">"Data/CMIP5/historical/CESM1-CAM5_historical/tas_Amon_CESM1-CAM5_historical_r1i1p1_185001-200512.nc"</span>, var <span class="op">=</span> <span class="st">"tas"</span>, lonLim <span class="op">=</span> <span class="va">cmip5.lon</span>, latLim <span class="op">=</span> <span class="va">cmip5.lat</span>, years <span class="op">=</span> <span class="fl">1961</span><span class="op">:</span><span class="fl">1990</span>, dictionary <span class="op">=</span> <span class="st">"Data/CMIP5/dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">cmip.tas</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"tas"</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, rev.colors <span class="op">=</span> <span class="cn">TRUE</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">40</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_ts_cmip5.png" alt=""><p class="caption">Figure 4. Historical (1961-90) CMIP5 data for mean
surface temperature (tas).</p>
</div>
</div>
<div class="tab-pane" id="tasmax-1" role="tabpanel" aria-labelledby="tasmax-1-tab">

<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cmip.tasmax</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData</a></span><span class="op">(</span><span class="st">"Data/CMIP5/historical/CESM1-CAM5_historical/tasmax_Amon_CESM1-CAM5_historical_r1i1p1_185001-200512.nc"</span>, var <span class="op">=</span> <span class="st">"tasmax"</span>, lonLim <span class="op">=</span> <span class="va">cmip5.lon</span>, latLim <span class="op">=</span> <span class="va">cmip5.lat</span>, years <span class="op">=</span> <span class="fl">1961</span><span class="op">:</span><span class="fl">1990</span>, dictionary <span class="op">=</span> <span class="st">"Data/CMIP5/dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">cmip.tasmax</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"tasmax"</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, rev.colors <span class="op">=</span> <span class="cn">TRUE</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">40</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_tsmx_cmip5.png" alt=""><p class="caption">Figure 4. Historical (1961-90) CMIP5 data for maximum
surface temperature (tasmax).</p>
</div>
</div>
<div class="tab-pane" id="pr-1" role="tabpanel" aria-labelledby="pr-1-tab">

<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cmip.pr</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData</a></span><span class="op">(</span><span class="st">"Data/CMIP5/historical/CESM1-CAM5_historical/pr_Amon_CESM1-CAM5_historical_r1i1p1_185001-200512.nc"</span>, var <span class="op">=</span> <span class="st">"pr"</span>, lonLim <span class="op">=</span> <span class="va">cmip5.lon</span>, latLim <span class="op">=</span> <span class="va">cmip5.lat</span>, years <span class="op">=</span> <span class="fl">1961</span><span class="op">:</span><span class="fl">1990</span>, dictionary <span class="op">=</span> <span class="st">"Data/CMIP5/dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">cmip.pr</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"pr"</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">400</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_pr_cmip5.png" alt=""><p class="caption">Figure 4. Historical (1961-90) CMIP5 data for
precipitation (pr).</p>
</div>
</div>
<div class="tab-pane" id="hurs-1" role="tabpanel" aria-labelledby="hurs-1-tab">

<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cmip.hurs</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData</a></span><span class="op">(</span><span class="st">"Data/CMIP5/historical/CESM1-CAM5_historical/hurs_Amon_CESM1-CAM5_historical_r1i1p1_185001-200512.nc"</span>, var <span class="op">=</span> <span class="st">"hurs"</span>, lonLim <span class="op">=</span> <span class="va">cmip5.lon</span>, latLim <span class="op">=</span> <span class="va">cmip5.lat</span>, years <span class="op">=</span> <span class="fl">1961</span><span class="op">:</span><span class="fl">1990</span>, dictionary <span class="op">=</span> <span class="st">"Data/CMIP5/dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">cmip.hurs</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"hurs"</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, rev.colors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_rhum_cmip5.png" alt=""><p class="caption">Figure 4. Historical (1961-90) CMIP5 data for
relative humidity (rhum).</p>
</div>
</div>
<div class="tab-pane" id="ps-2" role="tabpanel" aria-labelledby="ps-2-tab">

<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cmip.ps</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData</a></span><span class="op">(</span><span class="st">"Data/CMIP5/historical/CESM1-CAM5_historical/ps_Amon_CESM1-CAM5_historical_r1i1p1_185001-200512.nc"</span>, var <span class="op">=</span> <span class="st">"ps"</span>, lonLim <span class="op">=</span> <span class="va">cmip5.lon</span>, latLim <span class="op">=</span> <span class="va">cmip5.lat</span>, years <span class="op">=</span> <span class="fl">1961</span><span class="op">:</span><span class="fl">1990</span>, dictionary <span class="op">=</span> <span class="st">"Data/CMIP5/dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">cmip.ps</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"ps"</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, rev.colors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_ps_cmip5.png" alt=""><p class="caption">Figure 4. Historical (1961-90) CMIP5 data for surface
pressure (ps).</p>
</div>
</div>
<div class="tab-pane" id="cld-1" role="tabpanel" aria-labelledby="cld-1-tab">

<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cmip.cld</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData</a></span><span class="op">(</span><span class="st">"Data/CMIP5/historical/CESM1-CAM5_historical/clt_Amon_CESM1-CAM5_historical_r1i1p1_185001-200512.nc"</span>, var <span class="op">=</span> <span class="st">"cld"</span>, lonLim <span class="op">=</span> <span class="va">cmip5.lon</span>, latLim <span class="op">=</span> <span class="va">cmip5.lat</span>, years <span class="op">=</span> <span class="fl">1961</span><span class="op">:</span><span class="fl">1990</span>, dictionary <span class="op">=</span> <span class="st">"Data/CMIP5/dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">cmip.cld</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"cld"</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, rev.colors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_cld_cmip5.png" alt=""><p class="caption">Figure 4. Historical (1961-90) CMIP5 data for
cloudiness (cld).</p>
</div>
</div>
<div class="tab-pane" id="wss-2" role="tabpanel" aria-labelledby="wss-2-tab">

<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cmip.wss</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/loadGridData.html" class="external-link">loadGridData</a></span><span class="op">(</span><span class="st">"Data/CMIP5/historical/CESM1-CAM5_historical/sfcWind_Amon_CESM1-CAM5_historical_r1i1p1_185001-200512.nc"</span>, var <span class="op">=</span> <span class="st">"wss"</span>, lonLim <span class="op">=</span> <span class="va">cmip5.lon</span>, latLim <span class="op">=</span> <span class="va">cmip5.lat</span>, years <span class="op">=</span> <span class="fl">1961</span><span class="op">:</span><span class="fl">1990</span>, dictionary <span class="op">=</span> <span class="st">"Data/CMIP5/dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">cmip.wss</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"wss"</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span>, rev.colors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_load_wss_cmip5.png" alt=""><p class="caption">Figure 4. Historical (1961-90) CMIP5 data for wind
speed (wss).</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="fix-dates-1">Fix dates<a class="anchor" aria-label="anchor" href="#fix-dates-1"></a>
</h3>
<p>Similarly to the UERRA data, dates from the CMIP5 files match the
actual year and month, but are interpreted as the central date of the
month, rather than the whole range of data. Again, the
<code><a href="../reference/modifyDates.html">modifyDates()</a></code> function from the <a href="https://github.com/dinilu/dsclim" class="external-link">dsclim</a>
package modify the dates and fix helps to fix this small issue.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cmip.tasmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modifyDates.html">modifyDates</a></span><span class="op">(</span><span class="va">cmip.tasmax</span><span class="op">)</span></span>
<span><span class="va">cmip.tasmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modifyDates.html">modifyDates</a></span><span class="op">(</span><span class="va">cmip.tasmin</span><span class="op">)</span></span>
<span><span class="va">cmip.tas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modifyDates.html">modifyDates</a></span><span class="op">(</span><span class="va">cmip.tas</span><span class="op">)</span></span>
<span><span class="va">cmip.pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modifyDates.html">modifyDates</a></span><span class="op">(</span><span class="va">cmip.pr</span><span class="op">)</span></span>
<span><span class="va">cmip.ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modifyDates.html">modifyDates</a></span><span class="op">(</span><span class="va">cmip.ps</span><span class="op">)</span></span>
<span><span class="va">cmip.hurs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modifyDates.html">modifyDates</a></span><span class="op">(</span><span class="va">cmip.hurs</span><span class="op">)</span></span>
<span><span class="va">cmip.cld</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modifyDates.html">modifyDates</a></span><span class="op">(</span><span class="va">cmip.cld</span><span class="op">)</span></span>
<span><span class="va">cmip.wss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modifyDates.html">modifyDates</a></span><span class="op">(</span><span class="va">cmip.wss</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="make-multivariable-grid-1">Make multivariable grid<a class="anchor" aria-label="anchor" href="#make-multivariable-grid-1"></a>
</h3>
<p>Similarly to TraCE21ka dataset, the resulting objects for CMIP5
dataset can be combined in a multigrid object. This will be required
afterwards to use all those variables as predictors in the downscaling
process.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hist.cmip</span> <span class="op">&lt;-</span> <span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/makeMultiGrid.html" class="external-link">makeMultiGrid</a></span><span class="op">(</span><span class="va">cmip.tasmax</span>, <span class="va">cmip.tasmin</span>, <span class="va">cmip.tas</span>, <span class="va">cmip.pr</span>, <span class="va">cmip.hurs</span>, <span class="va">cmip.cld</span>, <span class="va">cmip.ps</span>, <span class="va">cmip.wss</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">cmip.tasmax</span>, <span class="va">cmip.tasmin</span>, <span class="va">cmip.tas</span>, <span class="va">cmip.pr</span>, <span class="va">cmip.hurs</span>, <span class="va">cmip.cld</span>, <span class="va">cmip.ps</span>, <span class="va">cmip.wss</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">visualizeR</span><span class="fu">::</span><span class="fu">spatialPlot</span><span class="op">(</span><span class="fu">transformeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/transformeR/man/climatology.html" class="external-link">climatology</a></span><span class="op">(</span><span class="va">hist.cmip</span><span class="op">)</span>, backdrop.theme <span class="op">=</span> <span class="st">"countries"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a2/a2_combine_historical_cmip5.png" alt=""><p class="caption">Figure 5. Multigrid (all variables in the same
object) historical (1961-90) CMIP5 data.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Diego Nieto-Lugilde, Daniel Romera-Romera.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
