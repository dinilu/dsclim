<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>1. Data downloading and preprocessing • dsclim</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="1. Data downloading and preprocessing">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dsclim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a1_Data_downloading_and_preprocessing.html">1. Data downloading and preprocessing</a></li>
    <li><a class="dropdown-item" href="../articles/a2_Load_source_data.html">2. Load source data</a></li>
    <li><a class="dropdown-item" href="../articles/a3_Downscale_with_Cross-validation.html">3. Downscaling with crossvalidation</a></li>
    <li><a class="dropdown-item" href="../articles/a4_Downscale_climate_data.html">4. Downscaling climate data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dinilu/dsclim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>1. Data downloading and preprocessing</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dinilu/dsclim/blob/v0.0.900/vignettes/a1_Data_downloading_and_preprocessing.Rmd" class="external-link"><code>vignettes/a1_Data_downloading_and_preprocessing.Rmd</code></a></small>
      <div class="d-none name"><code>a1_Data_downloading_and_preprocessing.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we illustrate how to download and preprocess the
climate data we used to downscale continuous climate data from the Last
Glacial Maximum (~22ka BP), to the future (2100 cal years). In
particular, we used data from TraCE21ka paleoreconstruction for the
past, Climate Model Intercomparison Project 5 (CIMP5) for the future,
and Uncertainties in Ensembles of Regional ReAnalyses (UERRA) for
historical period (i.e., 1961-1990) at high spatial resolution.</p>
<div class="section level2">
<h2 id="trace21ka-paleoclimate-data">TraCE21ka paleoclimate data<a class="anchor" aria-label="anchor" href="#trace21ka-paleoclimate-data"></a>
</h2>
<div class="section level3">
<h3 id="data-download">Data download<a class="anchor" aria-label="anchor" href="#data-download"></a>
</h3>
<p>TraCE21ka paleoclimate data can be downloaded from <a href="https://www.earthsystemgrid.org/project/trace.html" class="external-link">https://www.earthsystemgrid.org/project/trace.html</a>.
This website, however, does not provide documentation with detailed
information (e.g., meaning of file names, variable names, units,
etcetera). You can find such information in the following link <a href="http://www.cgd.ucar.edu/ccr/TraCE/fields.html" class="external-link">(http://www.cgd.ucar.edu/ccr/TraCE/fields.html)</a>.
Complementary information can be found in documentation website for the
model and the developing laboratory: <a href="http://www.cesm.ucar.edu/projects/community-projects/LENS/data-sets.html" class="external-link">http://www.cesm.ucar.edu/projects/community-projects/LENS/data-sets.html</a>
and <a href="http://www.cesm.ucar.edu/models/atm-cam/docs/cam2.0/UsersGuide/UG-45.html" class="external-link">http://www.cesm.ucar.edu/models/atm-cam/docs/cam2.0/UsersGuide/UG-45.html</a>.</p>
<p>We opted to download files for all time periods (since 22.000 years
BP to 1990 CE) for ‘surface temperature (radiative)’ (TS), ‘maximum
surface temperature over output period’ (TSMX), ‘minimum surface
temperature over output period’ (TSMN), ‘surface pressure’ (PS),
‘convective precipitation rate (liq + ice)’ (PRECC), ‘relative humidity’
(RELHUM), ‘wind speed (horizontal and vertical components)’ (U + V) and
‘vertically-integrated total cloud’ (CLDTOT).</p>
<div class="alert alert-primary" role="alert">
The code in the rest of the vignette assume you have downloaded at least
the files for the most recent time periods of each variable from the
TraCE21ka website. Those file should be stored under the following
folder structure since the working directory: Data/TraCE21ka/TSMX/
(changing TSMX for each variable accordingly).
</div>
</div>
<div class="section level3 tabset tabset-pills">
<h3 class="tabset tabset-pills" id="inspect-files-and-variables">Inspect files and variables<a class="anchor" aria-label="anchor" href="#inspect-files-and-variables"></a>
</h3>
<p>Downloaded files can be inspected with functions from the
<a href="https://github.com/SantanderMetGroup/loadeR/wiki" class="external-link">loadeR</a> package, using the the following code (select a
variable):</p>









<ul class="nav nav-pills" id="inspect-files-and-variables" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#tsmx" id="tsmx-tab" type="button" role="tab" aria-controls="tsmx" aria-selected="true" class="active nav-link">TSMX</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#tsmn" id="tsmn-tab" type="button" role="tab" aria-controls="tsmn" aria-selected="false" class="nav-link">TSMN</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#ts" id="ts-tab" type="button" role="tab" aria-controls="ts" aria-selected="false" class="nav-link">TS</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#precc" id="precc-tab" type="button" role="tab" aria-controls="precc" aria-selected="false" class="nav-link">PRECC</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#relhum" id="relhum-tab" type="button" role="tab" aria-controls="relhum" aria-selected="false" class="nav-link">RELHUM</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#cldtot" id="cldtot-tab" type="button" role="tab" aria-controls="cldtot" aria-selected="false" class="nav-link">CLDTOT</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#ps" id="ps-tab" type="button" role="tab" aria-controls="ps" aria-selected="false" class="nav-link">PS</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#u" id="u-tab" type="button" role="tab" aria-controls="u" aria-selected="false" class="nav-link">U</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#v" id="v-tab" type="button" role="tab" aria-controls="v" aria-selected="false" class="nav-link">V</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="tsmx" role="tabpanel" aria-labelledby="tsmx-tab">

<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">di.trace</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/dataInventory.html" class="external-link">dataInventory</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/TSMX/trace.36.400BP-1990CE.cam2.h0.TSMX.2160101-2204012.nc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">di.trace</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="tab-pane" id="tsmn" role="tabpanel" aria-labelledby="tsmn-tab">

<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">di.trace</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/dataInventory.html" class="external-link">dataInventory</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/TSMN/trace.36.400BP-1990CE.cam2.h0.TSMN.2160101-2204012.nc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">di.trace</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="tab-pane" id="ts" role="tabpanel" aria-labelledby="ts-tab">

<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">di.trace</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/dataInventory.html" class="external-link">dataInventory</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/TS/trace.36.400BP-1990CE.cam2.h0.TS.2160101-2204012.nc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">di.trace</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="tab-pane" id="precc" role="tabpanel" aria-labelledby="precc-tab">

<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">di.trace</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/dataInventory.html" class="external-link">dataInventory</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/PRECC/trace.36.400BP-1990CE.cam2.h0.PRECC.2160101-2204012.nc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">di.trace</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="tab-pane" id="relhum" role="tabpanel" aria-labelledby="relhum-tab">

<p>The file for relative humidity in TraCE21ka have information for
different atmospheric levels. In this case, we first selected surface
preasure level and then create a new file with the information to
simplify the subsequent computations.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># BASH script </span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="ex">cdo</span> sellevel,992.5561 Data/TraCE21ka/RELHUM/trace.36.400BP-1990CE.cam2.h0.RELHUM.2160101-2204012.nc Data/TraCE21ka/RELHUM/surface_level/trace.36.400BP-1990CE.cam2.h0.RELHUM.2160101-2204012.nc</span></code></pre></div>
<p>Once, the surface pressure level was selected the new file was
inspected.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">di.trace</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/dataInventory.html" class="external-link">dataInventory</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/RELHUM/surface_level/trace.36.400BP-1990CE.cam2.h0.RELHUM.2160101-2204012.nc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">di.trace</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="tab-pane" id="cldtot" role="tabpanel" aria-labelledby="cldtot-tab">

<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">di.trace</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/dataInventory.html" class="external-link">dataInventory</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/CLDTOT/trace.36.400BP-1990CE.cam2.h0.CLDTOT.2160101-2204012.nc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">di.trace</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="tab-pane" id="ps" role="tabpanel" aria-labelledby="ps-tab">

<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">di.trace</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/dataInventory.html" class="external-link">dataInventory</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/PS/trace.36.400BP-1990CE.cam2.h0.PS.2160101-2204012.nc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">di.trace</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="tab-pane" id="u" role="tabpanel" aria-labelledby="u-tab">

<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">di.trace</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/dataInventory.html" class="external-link">dataInventory</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/U/trace.36.400BP-1990CE.cam2.h0.U.2160101-2204012.nc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">di.trace</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="tab-pane" id="v" role="tabpanel" aria-labelledby="v-tab">

<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">di.trace</span> <span class="op">&lt;-</span> <span class="fu">loadeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/loadeR/man/dataInventory.html" class="external-link">dataInventory</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/V/trace.36.400BP-1990CE.cam2.h0.V.2160101-2204012.nc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">di.trace</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="create-dictionary">Create dictionary<a class="anchor" aria-label="anchor" href="#create-dictionary"></a>
</h3>
<p>In order to load those files in R, the <a href="https://github.com/SantanderMetGroup/climate4R" class="external-link">climate4R</a>
framework allow to create a dictionary that is used to standardize
variables.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.create</a></span><span class="op">(</span><span class="st">"Data/TraCE21ka/TraCE21ka_dictionary.dic"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"identifier,short_name,time_step,lower_time_bound,upper_time_bound,cell_method,offset,scale,deaccum,derived,interface"</span>,</span>
<span>    <span class="st">"tasmax,TSMX,1mo,0,12,max,-273.15,1,0,0,"</span>,</span>
<span>    <span class="st">"tasmin,TSMN,1mo,0,12,min,-273.15,1,0,0,"</span>,</span>
<span>    <span class="st">"tas,TS,1mo,0,12,mean,-273.15,1,0,0,"</span>,</span>
<span>    <span class="st">"pr,PRECC,1mo,0,12,mean,0,2592000000,0,0,"</span>,</span>
<span>    <span class="st">"hurs,RELHUM,1mo,0,12,mean,0,1,0,0,"</span>,</span>
<span>    <span class="st">"cld,CLDTOT,1mo,0,12,mean,0,1,0,0,"</span>,</span>
<span>    <span class="st">"ps,PS,1mo,0,12,mean,0,1,0,0,"</span>,</span>
<span>    <span class="st">"u,U,1mo,0,12,mean,0,1,0,0,"</span>,</span>
<span>    <span class="st">"v,V,1mo,0,12,mean,0,1,0,0,"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"Data/TraCE21ka/TraCE21ka_dictionary.dic"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="uerra-historical-reanalysis-data">UERRA historical reanalysis data<a class="anchor" aria-label="anchor" href="#uerra-historical-reanalysis-data"></a>
</h2>
<p>Reanalysis data for the historical period (1961-1990) comes from the
UERRA project (<a href="https://www.uerra.eu/" class="external-link">https://www.uerra.eu/</a>). The data can be
downloaded from the Climate Data Store at the Copernicus website (<a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-uerra-europe-single-levels?tab=overview" class="external-link">https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-uerra-europe-single-levels?tab=overview</a>).
Technical details can be found in the same Climate Data Store or at the
links provided in the website of the European Centre for Medium-Range
Weather Forecasts (ECMWF) for the UERRA project (<a href="https://www.ecmwf.int/en/research/projects/uerra" class="external-link">https://www.ecmwf.int/en/research/projects/uerra</a>).</p>
<p>The project provide reanalysis from two different systems
(UERRA-HARMONIE and MESCAN-SURFEX) that produce data in Lambert
Conformal Conic Grid at 6 hours temporal resolution and two spatial
resolutions: 11km x 11km for the UERRA-HARMONIE system and 5.5km x 5.5km
for the MESCAN-SURFEX system. Because reanalysis data would be our
predictand variables, we downloaded temperature, precipitation, relative
humidity, cloud cover, surface pressure, and wind speed data using the
following python scripts.</p>
<div class="alert alert-primary" role="alert">
Note that CDS requires to register a free account to access data.
Downloading scripts could request user and password in each iteration or
can be configured to store account data in the system. See prevous links
for detailed information.
</div>
<div class="alert alert-warning" role="alert">
Data were downloaded in GRIB format because the Climate Data Operator
library (cdo) seems to behave better with GRIB than with NetCDF files.
</div>
<div class="section level3 tabset tabset-pills">
<h3 class="tabset tabset-pills" id="downloading-files-from-dataserver">Downloading files from dataserver<a class="anchor" aria-label="anchor" href="#downloading-files-from-dataserver"></a>
</h3>
<p>While we were interested in downscaling at the spatial resolution of
the UERRA-HARMONIE, precipitation data were downloaded from the
MESCAN-SURFEX system. The main reason is that UERRA-HARMONIE doesn’t
provide precipitation data. Because MESCAN-SURFEX system produce data at
a finer spatial resolution they could be afterwards aggregated (or
upscaled) at the desired resolution.</p>






<ul class="nav nav-pills" id="downloading-files-from-dataserver" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#temperature" id="temperature-tab" type="button" role="tab" aria-controls="temperature" aria-selected="true" class="active nav-link">Temperature</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#precipitation" id="precipitation-tab" type="button" role="tab" aria-controls="precipitation" aria-selected="false" class="nav-link">Precipitation</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#relative-humidity" id="relative-humidity-tab" type="button" role="tab" aria-controls="relative-humidity" aria-selected="false" class="nav-link">Relative humidity</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#wind-speed" id="wind-speed-tab" type="button" role="tab" aria-controls="wind-speed" aria-selected="false" class="nav-link">Wind speed</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#total-cloud-cover" id="total-cloud-cover-tab" type="button" role="tab" aria-controls="total-cloud-cover" aria-selected="false" class="nav-link">Total cloud cover</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#surface-pressure" id="surface-pressure-tab" type="button" role="tab" aria-controls="surface-pressure" aria-selected="false" class="nav-link">Surface pressure</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="temperature" role="tabpanel" aria-labelledby="temperature-tab">

<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Python script </span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="im">import</span> cdsapi</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>c <span class="op">=</span> cdsapi.Client()</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1961</span>, <span class="dv">1990</span>):</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  <span class="bu">print</span>(y)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  </span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>  c.retrieve(</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>    <span class="st">'reanalysis-uerra-europe-single-levels'</span>,</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>    {</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>      <span class="st">'format'</span>: <span class="st">'grib'</span>,</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>      <span class="st">'origin'</span>: <span class="st">'uerra_harmonie'</span>,</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>      <span class="st">'variable'</span>: <span class="st">'2m_temperature'</span>,</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>      <span class="st">'year'</span>: [</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>        <span class="bu">str</span>(y),</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>        ],</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>      <span class="st">'month'</span>: [</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>        <span class="st">'01'</span>, <span class="st">'02'</span>, <span class="st">'03'</span>,</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>        <span class="st">'04'</span>, <span class="st">'05'</span>, <span class="st">'06'</span>,</span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>        <span class="st">'07'</span>, <span class="st">'08'</span>, <span class="st">'09'</span>,</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>        <span class="st">'10'</span>, <span class="st">'11'</span>, <span class="st">'12'</span>,</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>        ],</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>      <span class="st">'day'</span>: [</span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>        <span class="st">'01'</span>, <span class="st">'02'</span>, <span class="st">'03'</span>,</span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a>        <span class="st">'04'</span>, <span class="st">'05'</span>, <span class="st">'06'</span>,</span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>        <span class="st">'07'</span>, <span class="st">'08'</span>, <span class="st">'09'</span>,</span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a>        <span class="st">'10'</span>, <span class="st">'11'</span>, <span class="st">'12'</span>,</span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a>        <span class="st">'13'</span>, <span class="st">'14'</span>, <span class="st">'15'</span>,</span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a>        <span class="st">'16'</span>, <span class="st">'17'</span>, <span class="st">'18'</span>,</span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a>        <span class="st">'19'</span>, <span class="st">'20'</span>, <span class="st">'21'</span>,</span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a>        <span class="st">'22'</span>, <span class="st">'23'</span>, <span class="st">'24'</span>,</span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a>        <span class="st">'25'</span>, <span class="st">'26'</span>, <span class="st">'27'</span>,</span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a>        <span class="st">'28'</span>, <span class="st">'29'</span>, <span class="st">'30'</span>,</span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a>        <span class="st">'31'</span>,</span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a>        ],</span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a>      <span class="st">'time'</span>: [</span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a>        <span class="st">'00:00'</span>, <span class="st">'06:00'</span>, <span class="st">'12:00'</span>,</span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a>        <span class="st">'18:00'</span>,</span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a>        ],</span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a>    },</span>
<span id="cb12-42"><a href="#cb12-42" tabindex="-1"></a>    <span class="st">'UERRA-HARMONIE/2m_temperature/'</span><span class="op">+</span> <span class="bu">str</span>(y) <span class="op">+</span><span class="st">'_2m_temperature.grib'</span>)</span></code></pre></div>
</div>
<div class="tab-pane" id="precipitation" role="tabpanel" aria-labelledby="precipitation-tab">

<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Python script </span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="im">import</span> cdsapi</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>c <span class="op">=</span> cdsapi.Client()</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1961</span>, <span class="dv">1990</span>):</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  <span class="bu">print</span>(y)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  </span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>  c.retrieve(</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>    <span class="st">'reanalysis-uerra-europe-single-levels'</span>,</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>    {</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>      <span class="st">'format'</span>: <span class="st">'grib'</span>,</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>      <span class="st">'origin'</span>: <span class="st">'mescan_surfex'</span>,</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>      <span class="st">'variable'</span>: <span class="st">'total_precipitation'</span>,</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>      <span class="st">'year'</span>: [</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>        <span class="bu">str</span>(y),</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>        ],</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>      <span class="st">'month'</span>: [</span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>        <span class="st">'01'</span>, <span class="st">'02'</span>, <span class="st">'03'</span>,</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>        <span class="st">'04'</span>, <span class="st">'05'</span>, <span class="st">'06'</span>,</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>        <span class="st">'07'</span>, <span class="st">'08'</span>, <span class="st">'09'</span>,</span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>        <span class="st">'10'</span>, <span class="st">'11'</span>, <span class="st">'12'</span>,</span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>        ],</span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>      <span class="st">'day'</span>: [</span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a>        <span class="st">'01'</span>, <span class="st">'02'</span>, <span class="st">'03'</span>,</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a>        <span class="st">'04'</span>, <span class="st">'05'</span>, <span class="st">'06'</span>,</span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a>        <span class="st">'07'</span>, <span class="st">'08'</span>, <span class="st">'09'</span>,</span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a>        <span class="st">'10'</span>, <span class="st">'11'</span>, <span class="st">'12'</span>,</span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a>        <span class="st">'13'</span>, <span class="st">'14'</span>, <span class="st">'15'</span>,</span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a>        <span class="st">'16'</span>, <span class="st">'17'</span>, <span class="st">'18'</span>,</span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a>        <span class="st">'19'</span>, <span class="st">'20'</span>, <span class="st">'21'</span>,</span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a>        <span class="st">'22'</span>, <span class="st">'23'</span>, <span class="st">'24'</span>,</span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a>        <span class="st">'25'</span>, <span class="st">'26'</span>, <span class="st">'27'</span>,</span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a>        <span class="st">'28'</span>, <span class="st">'29'</span>, <span class="st">'30'</span>,</span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a>        <span class="st">'31'</span>,</span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a>        ],</span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a>      <span class="st">'time'</span>: [</span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a>        <span class="st">'00:00'</span>, <span class="st">'06:00'</span>, <span class="st">'12:00'</span>,</span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a>        <span class="st">'18:00'</span>,</span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a>        ],</span>
<span id="cb13-41"><a href="#cb13-41" tabindex="-1"></a>    },</span>
<span id="cb13-42"><a href="#cb13-42" tabindex="-1"></a>    <span class="st">'MESCAN-SURFEX/total_precipitation/'</span><span class="op">+</span> <span class="bu">str</span>(y) <span class="op">+</span><span class="st">'_total_precipitation.grib'</span>)</span></code></pre></div>
</div>
<div class="tab-pane" id="relative-humidity" role="tabpanel" aria-labelledby="relative-humidity-tab">

<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Python script </span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="im">import</span> cdsapi</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>c <span class="op">=</span> cdsapi.Client()</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1961</span>, <span class="dv">1990</span>):</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="bu">print</span>(y)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  </span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  c.retrieve(</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>    <span class="st">'reanalysis-uerra-europe-single-levels'</span>,</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>    {</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>      <span class="st">'format'</span>: <span class="st">'grib'</span>,</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>      <span class="st">'origin'</span>: <span class="st">'uerra_harmonie'</span>,</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>      <span class="st">'variable'</span>: <span class="st">'2m_relative_humidity'</span>,</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>      <span class="st">'year'</span>: [</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>        <span class="bu">str</span>(y),</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>        ],</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>      <span class="st">'month'</span>: [</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>        <span class="st">'01'</span>, <span class="st">'02'</span>, <span class="st">'03'</span>,</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>        <span class="st">'04'</span>, <span class="st">'05'</span>, <span class="st">'06'</span>,</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>        <span class="st">'07'</span>, <span class="st">'08'</span>, <span class="st">'09'</span>,</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a>        <span class="st">'10'</span>, <span class="st">'11'</span>, <span class="st">'12'</span>,</span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>        ],</span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>      <span class="st">'day'</span>: [</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>        <span class="st">'01'</span>, <span class="st">'02'</span>, <span class="st">'03'</span>,</span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>        <span class="st">'04'</span>, <span class="st">'05'</span>, <span class="st">'06'</span>,</span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a>        <span class="st">'07'</span>, <span class="st">'08'</span>, <span class="st">'09'</span>,</span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a>        <span class="st">'10'</span>, <span class="st">'11'</span>, <span class="st">'12'</span>,</span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a>        <span class="st">'13'</span>, <span class="st">'14'</span>, <span class="st">'15'</span>,</span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a>        <span class="st">'16'</span>, <span class="st">'17'</span>, <span class="st">'18'</span>,</span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a>        <span class="st">'19'</span>, <span class="st">'20'</span>, <span class="st">'21'</span>,</span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a>        <span class="st">'22'</span>, <span class="st">'23'</span>, <span class="st">'24'</span>,</span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a>        <span class="st">'25'</span>, <span class="st">'26'</span>, <span class="st">'27'</span>,</span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a>        <span class="st">'28'</span>, <span class="st">'29'</span>, <span class="st">'30'</span>,</span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a>        <span class="st">'31'</span>,</span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a>        ],</span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a>      <span class="st">'time'</span>: [</span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a>        <span class="st">'00:00'</span>, <span class="st">'06:00'</span>, <span class="st">'12:00'</span>,</span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a>        <span class="st">'18:00'</span>,</span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a>        ],</span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a>    },</span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a>    <span class="st">'UERRA-HARMONIE/2m_relative_humidity/'</span><span class="op">+</span> <span class="bu">str</span>(y) <span class="op">+</span><span class="st">'_2m_relative_humidity.grib'</span>)</span></code></pre></div>
</div>
<div class="tab-pane" id="wind-speed" role="tabpanel" aria-labelledby="wind-speed-tab">

<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Python script </span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="im">import</span> cdsapi</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>c <span class="op">=</span> cdsapi.Client()</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1961</span>, <span class="dv">1990</span>):</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="bu">print</span>(y)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  </span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>  c.retrieve(</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>    <span class="st">'reanalysis-uerra-europe-single-levels'</span>,</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>    {</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>      <span class="st">'format'</span>: <span class="st">'grib'</span>,</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>      <span class="st">'origin'</span>: <span class="st">'uerra_harmonie'</span>,</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>      <span class="st">'variable'</span>: <span class="st">'10m_wind_speed'</span>,</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>      <span class="st">'year'</span>: [</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>        <span class="bu">str</span>(y),</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>        ],</span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>      <span class="st">'month'</span>: [</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>        <span class="st">'01'</span>, <span class="st">'02'</span>, <span class="st">'03'</span>,</span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a>        <span class="st">'04'</span>, <span class="st">'05'</span>, <span class="st">'06'</span>,</span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>        <span class="st">'07'</span>, <span class="st">'08'</span>, <span class="st">'09'</span>,</span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>        <span class="st">'10'</span>, <span class="st">'11'</span>, <span class="st">'12'</span>,</span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a>        ],</span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a>      <span class="st">'day'</span>: [</span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a>        <span class="st">'01'</span>, <span class="st">'02'</span>, <span class="st">'03'</span>,</span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a>        <span class="st">'04'</span>, <span class="st">'05'</span>, <span class="st">'06'</span>,</span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a>        <span class="st">'07'</span>, <span class="st">'08'</span>, <span class="st">'09'</span>,</span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a>        <span class="st">'10'</span>, <span class="st">'11'</span>, <span class="st">'12'</span>,</span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a>        <span class="st">'13'</span>, <span class="st">'14'</span>, <span class="st">'15'</span>,</span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a>        <span class="st">'16'</span>, <span class="st">'17'</span>, <span class="st">'18'</span>,</span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a>        <span class="st">'19'</span>, <span class="st">'20'</span>, <span class="st">'21'</span>,</span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a>        <span class="st">'22'</span>, <span class="st">'23'</span>, <span class="st">'24'</span>,</span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a>        <span class="st">'25'</span>, <span class="st">'26'</span>, <span class="st">'27'</span>,</span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a>        <span class="st">'28'</span>, <span class="st">'29'</span>, <span class="st">'30'</span>,</span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a>        <span class="st">'31'</span>,</span>
<span id="cb15-36"><a href="#cb15-36" tabindex="-1"></a>        ],</span>
<span id="cb15-37"><a href="#cb15-37" tabindex="-1"></a>      <span class="st">'time'</span>: [</span>
<span id="cb15-38"><a href="#cb15-38" tabindex="-1"></a>        <span class="st">'00:00'</span>, <span class="st">'06:00'</span>, <span class="st">'12:00'</span>,</span>
<span id="cb15-39"><a href="#cb15-39" tabindex="-1"></a>        <span class="st">'18:00'</span>,</span>
<span id="cb15-40"><a href="#cb15-40" tabindex="-1"></a>        ],</span>
<span id="cb15-41"><a href="#cb15-41" tabindex="-1"></a>    },</span>
<span id="cb15-42"><a href="#cb15-42" tabindex="-1"></a>    <span class="st">'UERRA-HARMONIE/10m_wind_speed/'</span><span class="op">+</span> <span class="bu">str</span>(y) <span class="op">+</span><span class="st">'_10m_wind_speed.grib'</span>)</span></code></pre></div>
</div>
<div class="tab-pane" id="total-cloud-cover" role="tabpanel" aria-labelledby="total-cloud-cover-tab">

<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Python script </span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="im">import</span> cdsapi</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>c <span class="op">=</span> cdsapi.Client()</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1961</span>, <span class="dv">1990</span>):</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  <span class="bu">print</span>(y)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  </span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>  c.retrieve(</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>    <span class="st">'reanalysis-uerra-europe-single-levels'</span>,</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>    {</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>      <span class="st">'format'</span>: <span class="st">'grib'</span>,</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>      <span class="st">'origin'</span>: <span class="st">'uerra_harmonie'</span>,</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>      <span class="st">'variable'</span>: <span class="st">'total_cloud_cover'</span>,</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>      <span class="st">'year'</span>: [</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>        <span class="bu">str</span>(y),</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>        ],</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>      <span class="st">'month'</span>: [</span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>        <span class="st">'01'</span>, <span class="st">'02'</span>, <span class="st">'03'</span>,</span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a>        <span class="st">'04'</span>, <span class="st">'05'</span>, <span class="st">'06'</span>,</span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a>        <span class="st">'07'</span>, <span class="st">'08'</span>, <span class="st">'09'</span>,</span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a>        <span class="st">'10'</span>, <span class="st">'11'</span>, <span class="st">'12'</span>,</span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a>        ],</span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a>      <span class="st">'day'</span>: [</span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a>        <span class="st">'01'</span>, <span class="st">'02'</span>, <span class="st">'03'</span>,</span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a>        <span class="st">'04'</span>, <span class="st">'05'</span>, <span class="st">'06'</span>,</span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a>        <span class="st">'07'</span>, <span class="st">'08'</span>, <span class="st">'09'</span>,</span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a>        <span class="st">'10'</span>, <span class="st">'11'</span>, <span class="st">'12'</span>,</span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a>        <span class="st">'13'</span>, <span class="st">'14'</span>, <span class="st">'15'</span>,</span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a>        <span class="st">'16'</span>, <span class="st">'17'</span>, <span class="st">'18'</span>,</span>
<span id="cb16-31"><a href="#cb16-31" tabindex="-1"></a>        <span class="st">'19'</span>, <span class="st">'20'</span>, <span class="st">'21'</span>,</span>
<span id="cb16-32"><a href="#cb16-32" tabindex="-1"></a>        <span class="st">'22'</span>, <span class="st">'23'</span>, <span class="st">'24'</span>,</span>
<span id="cb16-33"><a href="#cb16-33" tabindex="-1"></a>        <span class="st">'25'</span>, <span class="st">'26'</span>, <span class="st">'27'</span>,</span>
<span id="cb16-34"><a href="#cb16-34" tabindex="-1"></a>        <span class="st">'28'</span>, <span class="st">'29'</span>, <span class="st">'30'</span>,</span>
<span id="cb16-35"><a href="#cb16-35" tabindex="-1"></a>        <span class="st">'31'</span>,</span>
<span id="cb16-36"><a href="#cb16-36" tabindex="-1"></a>        ],</span>
<span id="cb16-37"><a href="#cb16-37" tabindex="-1"></a>      <span class="st">'time'</span>: [</span>
<span id="cb16-38"><a href="#cb16-38" tabindex="-1"></a>        <span class="st">'00:00'</span>, <span class="st">'06:00'</span>, <span class="st">'12:00'</span>,</span>
<span id="cb16-39"><a href="#cb16-39" tabindex="-1"></a>        <span class="st">'18:00'</span>,</span>
<span id="cb16-40"><a href="#cb16-40" tabindex="-1"></a>        ],</span>
<span id="cb16-41"><a href="#cb16-41" tabindex="-1"></a>    },</span>
<span id="cb16-42"><a href="#cb16-42" tabindex="-1"></a>    <span class="st">'UERRA-HARMONIE/total_cloud_cover/'</span><span class="op">+</span> <span class="bu">str</span>(y) <span class="op">+</span><span class="st">'_total_cloud_cover.grib'</span>)</span></code></pre></div>
</div>
<div class="tab-pane" id="surface-pressure" role="tabpanel" aria-labelledby="surface-pressure-tab">

<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Python script </span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="im">import</span> cdsapi</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>c <span class="op">=</span> cdsapi.Client()</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1961</span>, <span class="dv">1990</span>):</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  <span class="bu">print</span>(y)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>  </span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>  c.retrieve(</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>    <span class="st">'reanalysis-uerra-europe-single-levels'</span>,</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>    {</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>      <span class="st">'format'</span>: <span class="st">'grib'</span>,</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>      <span class="st">'origin'</span>: <span class="st">'uerra_harmonie'</span>,</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>      <span class="st">'variable'</span>: <span class="st">'surface_pressure'</span>,</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>      <span class="st">'year'</span>: [</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>        <span class="bu">str</span>(y),</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>        ],</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a>      <span class="st">'month'</span>: [</span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>        <span class="st">'01'</span>, <span class="st">'02'</span>, <span class="st">'03'</span>,</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>        <span class="st">'04'</span>, <span class="st">'05'</span>, <span class="st">'06'</span>,</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>        <span class="st">'07'</span>, <span class="st">'08'</span>, <span class="st">'09'</span>,</span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a>        <span class="st">'10'</span>, <span class="st">'11'</span>, <span class="st">'12'</span>,</span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a>        ],</span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a>      <span class="st">'day'</span>: [</span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a>        <span class="st">'01'</span>, <span class="st">'02'</span>, <span class="st">'03'</span>,</span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a>        <span class="st">'04'</span>, <span class="st">'05'</span>, <span class="st">'06'</span>,</span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a>        <span class="st">'07'</span>, <span class="st">'08'</span>, <span class="st">'09'</span>,</span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a>        <span class="st">'10'</span>, <span class="st">'11'</span>, <span class="st">'12'</span>,</span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a>        <span class="st">'13'</span>, <span class="st">'14'</span>, <span class="st">'15'</span>,</span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a>        <span class="st">'16'</span>, <span class="st">'17'</span>, <span class="st">'18'</span>,</span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a>        <span class="st">'19'</span>, <span class="st">'20'</span>, <span class="st">'21'</span>,</span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a>        <span class="st">'22'</span>, <span class="st">'23'</span>, <span class="st">'24'</span>,</span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a>        <span class="st">'25'</span>, <span class="st">'26'</span>, <span class="st">'27'</span>,</span>
<span id="cb17-34"><a href="#cb17-34" tabindex="-1"></a>        <span class="st">'28'</span>, <span class="st">'29'</span>, <span class="st">'30'</span>,</span>
<span id="cb17-35"><a href="#cb17-35" tabindex="-1"></a>        <span class="st">'31'</span>,</span>
<span id="cb17-36"><a href="#cb17-36" tabindex="-1"></a>        ],</span>
<span id="cb17-37"><a href="#cb17-37" tabindex="-1"></a>      <span class="st">'time'</span>: [</span>
<span id="cb17-38"><a href="#cb17-38" tabindex="-1"></a>        <span class="st">'00:00'</span>, <span class="st">'06:00'</span>, <span class="st">'12:00'</span>,</span>
<span id="cb17-39"><a href="#cb17-39" tabindex="-1"></a>        <span class="st">'18:00'</span>,</span>
<span id="cb17-40"><a href="#cb17-40" tabindex="-1"></a>        ],</span>
<span id="cb17-41"><a href="#cb17-41" tabindex="-1"></a>    },</span>
<span id="cb17-42"><a href="#cb17-42" tabindex="-1"></a>    <span class="st">'UERRA-HARMONIE/surface_pressure/'</span><span class="op">+</span> <span class="bu">str</span>(y) <span class="op">+</span><span class="st">'_surface_pressure.grib'</span>)</span></code></pre></div>
</div>
</div>
</div>
<div class="section level3 tabset tabset-pills">
<h3 class="tabset tabset-pills" id="reprojection-and-data-aggregation">Reprojection and data aggregation<a class="anchor" aria-label="anchor" href="#reprojection-and-data-aggregation"></a>
</h3>
<p>UERRA data come in Lambert Conformal Conic Grid projection that
should be transformed to WGS84 to match with data from TraCE21ka and
CMIP5. Furthermore, subdaily (6 hour) data from the original files were
aggregated to daily and then monthly data. All variables were kept in
their original metric and units, but temperature that was used to
calculate maximum, minimum, and mean daily temperatures, and then
monthly averages. In the case of precipitations, the aggregation was
carried out by summing daily data, for the rest of variables aggregation
was carried out by averaging subdaily (to daily) and daily (to monthly)
data. All these transformations were carried out using the Climate Data
Operator library (cdo).</p>






<ul class="nav nav-pills" id="reprojection-and-data-aggregation" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#temperature-1" id="temperature-1-tab" type="button" role="tab" aria-controls="temperature-1" aria-selected="true" class="active nav-link">Temperature</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#precipitation-1" id="precipitation-1-tab" type="button" role="tab" aria-controls="precipitation-1" aria-selected="false" class="nav-link">Precipitation</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#cloudiness" id="cloudiness-tab" type="button" role="tab" aria-controls="cloudiness" aria-selected="false" class="nav-link">Cloudiness</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#relative-humidity-1" id="relative-humidity-1-tab" type="button" role="tab" aria-controls="relative-humidity-1" aria-selected="false" class="nav-link">Relative humidity</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#wind-speed-1" id="wind-speed-1-tab" type="button" role="tab" aria-controls="wind-speed-1" aria-selected="false" class="nav-link">Wind speed</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#surface-pressure-1" id="surface-pressure-1-tab" type="button" role="tab" aria-controls="surface-pressure-1" aria-selected="false" class="nav-link">Surface pressure</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="temperature-1" role="tabpanel" aria-labelledby="temperature-1-tab">

<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># BASH script </span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="va">years</span><span class="op">=</span><span class="va">($(</span><span class="fu">seq</span> 1961 1990<span class="va">))</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="st">"</span><span class="va">${years</span><span class="op">[@]</span><span class="va">}</span><span class="st">"</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co"># Temporal and spatial aggregation</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="ex">cdo</span> <span class="at">-s</span> <span class="at">-f</span> nc remapcon,Data/UERRA/template_HARMONIE.nc <span class="at">-monavg</span> <span class="at">-daymin</span> Data/UERRA/UERRA-HARMONIE/2m_temperature/<span class="va">${y}</span>_2m_temperature.grib Data/UERRA/UERRA-HARMONIE/2m_temperature/latlon/<span class="va">${y}</span>_2m_tmin.nc</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="ex">cdo</span> <span class="at">-s</span> <span class="at">-f</span> nc remapcon,Data/UERRA/template_HARMONIE.nc <span class="at">-monavg</span> <span class="at">-daymax</span> Data/UERRA/UERRA-HARMONIE/2m_temperature/<span class="va">${y}</span>_2m_temperature.grib Data/UERRA/UERRA-HARMONIE/2m_temperature/latlon/<span class="va">${y}</span>_2m_tmax.nc</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="ex">cdo</span> <span class="at">-s</span> <span class="at">-f</span> nc remapcon,Data/UERRA/template_HARMONIE.nc <span class="at">-monavg</span> <span class="at">-dayavg</span> Data/UERRA/UERRA-HARMONIE/2m_temperature/<span class="va">${y}</span>_2m_temperature.grib Data/UERRA/UERRA-HARMONIE/2m_temperature/latlon/<span class="va">${y}</span>_2m_temperature.nc</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co"># Temporal merging</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="va">tmin_files</span><span class="op">=</span><span class="va">(</span> Data/UERRA/UERRA-HARMONIE/2m_temperature/latlon/<span class="pp">*</span>_2m_tmin.nc <span class="va">)</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="ex">cdo</span> mergetime <span class="va">${tmin_files</span><span class="op">[@]</span><span class="va">}</span>  Data/UERRA/UERRA-HARMONIE/2m_temperature/latlon/1961-90_2m_tmin.nc</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="va">tmax_files</span><span class="op">=</span><span class="va">(</span> Data/UERRA/UERRA-HARMONIE/2m_temperature/latlon/<span class="pp">*</span>_2m_tmax.nc <span class="va">)</span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="ex">cdo</span> mergetime <span class="va">${tmax_files</span><span class="op">[@]</span><span class="va">}</span> Data/UERRA/UERRA-HARMONIE/2m_temperature/latlon/1961-90_2m_tmax.nc</span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="va">tmean_files</span><span class="op">=</span><span class="va">(</span> Data/UERRA/UERRA-HARMONIE/2m_temperature/latlon/<span class="pp">*</span>_2m_temperature.nc <span class="va">)</span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="ex">cdo</span> mergetime <span class="va">${tmean_files</span><span class="op">[@]</span><span class="va">}</span> Data/UERRA/UERRA-HARMONIE/2m_temperature/latlon/1961-90_2m_temperature.nc</span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a><span class="co"># Remove temporary files</span></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a><span class="fu">rm</span> <span class="va">${tmin_files</span><span class="op">[@]</span><span class="va">}</span> <span class="va">${tmax_files</span><span class="op">[@]</span><span class="va">}</span> <span class="va">${tmean_files</span><span class="op">[@]</span><span class="va">}</span></span></code></pre></div>
</div>
<div class="tab-pane" id="precipitation-1" role="tabpanel" aria-labelledby="precipitation-1-tab">

<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># BASH script </span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="va">years</span><span class="op">=</span><span class="va">($(</span><span class="fu">seq</span> 1961 1990<span class="va">))</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="st">"</span><span class="va">${years</span><span class="op">[@]</span><span class="va">}</span><span class="st">"</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co"># Temporal and spatial aggregation</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="ex">cdo</span> <span class="at">-s</span> <span class="at">-f</span> nc remapcon,Data/UERRA/template_SURFEX.nc <span class="at">-monsum</span> Data/UERRA/MESCAN-SURFEX/total_precipitation/<span class="va">${y}</span>_total_precipitation.grib Data/UERRA/MESCAN-SURFEX/total_precipitation/latlon/<span class="va">${y}</span>_total_precipitation.nc</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co"># Temporal merging</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="va">prec_files</span><span class="op">=</span><span class="va">(</span> Data/UERRA/MESCAN-SURFEX/total_precipitation/latlon/<span class="pp">*</span>_total_precipitation.nc <span class="va">)</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="ex">cdo</span> mergetime <span class="va">${prec_files</span><span class="op">[@]</span><span class="va">}</span> Data/UERRA/MESCAN-SURFEX/total_precipitation/latlon/1961-90_total_precipitation.nc</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co"># Remove temporary files</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="fu">rm</span> <span class="va">${prec_files</span><span class="op">[@]</span><span class="va">}</span> </span></code></pre></div>
</div>
<div class="tab-pane" id="cloudiness" role="tabpanel" aria-labelledby="cloudiness-tab">

<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># BASH script </span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="va">years</span><span class="op">=</span><span class="va">($(</span><span class="fu">seq</span> 1961 1990<span class="va">))</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="st">"</span><span class="va">${years</span><span class="op">[@]</span><span class="va">}</span><span class="st">"</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co"># Temporal and spatial aggregation</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="ex">cdo</span> <span class="at">-s</span> <span class="at">-f</span> nc remapcon,Data/UERRA/template_HARMONIE.nc <span class="at">-monavg</span> Data/UERRA/UERRA-HARMONIE/total_cloud_cover/<span class="va">${y}</span>_total_cloud_cover.grib Data/UERRA/UERRA-HARMONIE/total_cloud_cover/latlon/<span class="va">${y}</span>_total_cloud_cover.nc</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co"># Temporal merging</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="va">cloud_files</span><span class="op">=</span><span class="va">(</span> Data/UERRA/UERRA-HARMONIE/total_cloud_cover/latlon/<span class="pp">*</span>_total_cloud_cover.nc <span class="va">)</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="ex">cdo</span> mergetime <span class="va">${cloud_files</span><span class="op">[@]</span><span class="va">}</span>  Data/UERRA/UERRA-HARMONIE/total_cloud_cover/latlon/1961-90_total_cloud_cover.nc</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="co"># Remove temporary files</span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a><span class="fu">rm</span> <span class="va">${cloud_files</span><span class="op">[@]</span><span class="va">}</span> </span></code></pre></div>
</div>
<div class="tab-pane" id="relative-humidity-1" role="tabpanel" aria-labelledby="relative-humidity-1-tab">

<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># BASH script </span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="va">years</span><span class="op">=</span><span class="va">($(</span><span class="fu">seq</span> 1961 1990<span class="va">))</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="st">"</span><span class="va">${years</span><span class="op">[@]</span><span class="va">}</span><span class="st">"</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co"># Temporal and spatial aggregation</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="ex">cdo</span> <span class="at">-s</span> <span class="at">-f</span> nc remapcon,Data/UERRA/template_HARMONIE.nc <span class="at">-monavg</span> Data/UERRA/UERRA-HARMONIE/2m_relative_humidity/<span class="va">${y}</span>_2m_relative_humidity.grib Data/UERRA/UERRA-HARMONIE/2m_relative_humidity/latlon/<span class="va">${y}</span>_2m_relative_humidity.nc</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="co"># Temporal merging</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="va">rhum_files</span><span class="op">=</span><span class="va">(</span> Data/UERRA/UERRA-HARMONIE/2m_relative_humidity/latlon/<span class="pp">*</span>_2m_relative_humidity.nc <span class="va">)</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="ex">cdo</span> mergetime <span class="va">${rhum_files</span><span class="op">[@]</span><span class="va">}</span> Data/UERRA/UERRA-HARMONIE/2m_relative_humidity/latlon/1961-90_2m_relative_humidity.nc</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="co"># Remove temporary files</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="fu">rm</span> <span class="va">${rhum_files</span><span class="op">[@]</span><span class="va">}</span></span></code></pre></div>
</div>
<div class="tab-pane" id="wind-speed-1" role="tabpanel" aria-labelledby="wind-speed-1-tab">

<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># BASH script </span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="va">years</span><span class="op">=</span><span class="va">($(</span><span class="fu">seq</span> 1961 1990<span class="va">))</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="st">"</span><span class="va">${years</span><span class="op">[@]</span><span class="va">}</span><span class="st">"</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co"># Temporal and spatial aggregation</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="ex">cdo</span> <span class="at">-s</span> <span class="at">-f</span> nc remapcon,Data/UERRA/template_HARMONIE.nc <span class="at">-monavg</span> Data/UERRA/UERRA-HARMONIE/10m_wind_speed/<span class="va">${y}</span>_10m_wind_speed.grib Data/UERRA/UERRA-HARMONIE/10m_wind_speed/latlon/<span class="va">${y}</span>_10m_wind_speed.nc</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co"># Temporal merging</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="va">wspeed_files</span><span class="op">=</span><span class="va">(</span> Data/UERRA/UERRA-HARMONIE/10m_wind_speed/latlon/<span class="pp">*</span>_10m_wind_speed.nc <span class="va">)</span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="ex">cdo</span> mergetime <span class="va">${wspeed_files</span><span class="op">[@]</span><span class="va">}</span> Data/UERRA/UERRA-HARMONIE/10m_wind_speed/latlon/1961-90_10m_wind_speed.nc</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="co"># Remove temporary files</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a><span class="fu">rm</span> <span class="va">${wspeed_files</span><span class="op">[@]</span><span class="va">}</span> </span></code></pre></div>
</div>
<div class="tab-pane" id="surface-pressure-1" role="tabpanel" aria-labelledby="surface-pressure-1-tab">

<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># BASH script </span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="va">years</span><span class="op">=</span><span class="va">($(</span><span class="fu">seq</span> 1961 1990<span class="va">))</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="st">"</span><span class="va">${years</span><span class="op">[@]</span><span class="va">}</span><span class="st">"</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co"># Temporal and spatial aggregation</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="ex">cdo</span> <span class="at">-s</span> <span class="at">-f</span> nc remapcon,Data/UERRA/template_HARMONIE.nc <span class="at">-monavg</span> Data/UERRA/UERRA-HARMONIE/surface_pressure/<span class="va">${y}</span>_surface_pressure.grib Data/UERRA/UERRA-HARMONIE/surface_pressure/latlon/<span class="va">${y}</span>_surface_pressure.nc</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="co"># Temporal merging</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="va">ps_files</span><span class="op">=</span><span class="va">(</span> Data/UERRA/UERRA-HARMONIE/surface_pressure/latlon/<span class="pp">*</span>_surface_pressure.nc <span class="va">)</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="ex">cdo</span> mergetime <span class="va">${ps_files</span><span class="op">[@]</span><span class="va">}</span> Data/UERRA/UERRA-HARMONIE/surface_pressure/latlon/1961-90_surface_pressure.nc</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="co"># Remove temporary files</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="fu">rm</span> <span class="va">${ps_files}</span> </span></code></pre></div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="create-dictionary-1">Create dictionary<a class="anchor" aria-label="anchor" href="#create-dictionary-1"></a>
</h3>
<p>In order to load those files in R, the <a href="https://github.com/SantanderMetGroup/climate4R" class="external-link">climate4R</a>
framework allow to create a dictionary that is used to standardize
variables to the <code>climate4R</code> vocabulary (check
<code><a href="https://rdrr.io/pkg/climate4R.UDG/man/C4R.vocabulary.html" class="external-link">climate4R.UDG::C4R.vocabulary()</a></code>).</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.create</a></span><span class="op">(</span><span class="st">"Data/UERRA/UERRA_dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"identifier,short_name,time_step,lower_time_bound,upper_time_bound,cell_method,offset,scale,deaccum,derived,interface"</span>,</span>
<span>    <span class="st">"tasmin,2t,1mo,1,12,min,-273.15,1,0,0,"</span>,</span>
<span>    <span class="st">"tasmax,2t,1mo,1,12,max,-273.15,1,0,0,"</span>,</span>
<span>    <span class="st">"tas,2t,1mo,1,12,mean,-273.15,1,0,0,"</span>,</span>
<span>    <span class="st">"pr,tp,1mo,1,12,sum,0,1,0,0,"</span>,</span>
<span>    <span class="st">"hurs,2r,1mo,1,12,mean,0,1,0,0,"</span>,</span>
<span>    <span class="st">"cld,tcc,1mo,1,12,mean,0,1,0,0,"</span>,</span>
<span>    <span class="st">"wss,10si,1mo,1,12,mean,0,1,0,0,"</span>,</span>
<span>    <span class="st">"ps,sp,1mo,1,12,mean,0,1,0,0,"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"Data/UERRA/UERRA_dictionary.dic"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="cmip5-data">CMIP5 data<a class="anchor" aria-label="anchor" href="#cmip5-data"></a>
</h2>
<p>CMIP5 data are available from different sources (e.g., <a href="https://www.wcrp-climate.org/wgcm-cmip/wgcm-cmip5" class="external-link">CMIP5
website</a> or the Climate Data Store). Given the convenience
downloading system of the Climate Data Store, which we use also to
download UERRA data, we selected this option.</p>
<div class="section level3">
<h3 id="downloading-files-from-dataserver-1">Downloading files from dataserver<a class="anchor" aria-label="anchor" href="#downloading-files-from-dataserver-1"></a>
</h3>
<p>CMIP5 data were download for two periods. On the one hand, historical
period which correspond to 1850-2005 interval in the CMIP5 project. On
the other hand, future scenarios projections which corresponded to
2006-2100 interval. Although there are available data from multiple
General Circulation Models (GCMs) in the CMIP5 datasets, there were only
three that have all the needed variables for the all four representative
path ways (RCPs). Hence, we downloaded the needed variables (matching
those from the TraCE21ka and UERRA datasets) for such three GCMs and
four RCPs.</p>
<div class="alert alert-primary" role="alert">
Note that CDS requires to register a free account to access data.
Downloading scripts could request user and password in each iteration or
can be configured to store account data in the system.
</div>
<div class="section level4 tabset tabset-pils">
<h4 class="tabset tabset-pils" id="historical-data">Historical data<a class="anchor" aria-label="anchor" href="#historical-data"></a>
</h4>
<p>Select a GCM</p>



<ul class="nav nav-tabs" id="historical-data" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#cesm1_cam5" id="cesm1_cam5-tab" type="button" role="tab" aria-controls="cesm1_cam5" aria-selected="true" class="active nav-link">CESM1_CAM5</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#csiro-mk3-6-0" id="csiro-mk3-6-0-tab" type="button" role="tab" aria-controls="csiro-mk3-6-0" aria-selected="false" class="nav-link">CSIRO-Mk3-6-0</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#ipsl-cm5a-mr" id="ipsl-cm5a-mr-tab" type="button" role="tab" aria-controls="ipsl-cm5a-mr" aria-selected="false" class="nav-link">IPSL-CM5A-MR</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="cesm1_cam5" role="tabpanel" aria-labelledby="cesm1_cam5-tab">

<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="im">import</span> cdsapi</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>c <span class="op">=</span> cdsapi.Client()</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>c.retrieve(</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>  <span class="st">'projections-cmip5-monthly-single-levels'</span>,</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>  {</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>    <span class="st">'ensemble_member'</span>: <span class="st">'r1i1p1'</span>,</span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>    <span class="st">'format'</span>: <span class="st">'zip'</span>,</span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>    <span class="st">'experiment'</span>: <span class="st">'historical'</span>,</span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>    <span class="st">'variable'</span>: [</span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>      <span class="st">'10m_wind_speed'</span>,</span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>      <span class="st">'2m_temperature'</span>,</span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a>      <span class="st">'maximum_2m_temperature_in_the_last_24_hours'</span>,</span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a>      <span class="st">'minimum_2m_temperature_in_the_last_24_hours'</span>,</span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a>      <span class="st">'near_surface_relative_humidity'</span>,</span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a>      <span class="st">'surface_pressure'</span>,</span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a>      <span class="st">'total_cloud_cover'</span>,</span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a>      <span class="st">'mean_precipitation_flux'</span>, </span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a>      ],</span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a>    <span class="st">'model'</span>: <span class="st">'cesm1_cam5'</span>,</span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a>    <span class="st">'period'</span>: <span class="st">'185001-200512'</span>,</span>
<span id="cb25-23"><a href="#cb25-23" tabindex="-1"></a>  },</span>
<span id="cb25-24"><a href="#cb25-24" tabindex="-1"></a>  <span class="st">'CESM1-CAM5_historical.zip'</span>)</span></code></pre></div>
</div>
<div class="tab-pane" id="csiro-mk3-6-0" role="tabpanel" aria-labelledby="csiro-mk3-6-0-tab">

<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="im">import</span> cdsapi</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>c <span class="op">=</span> cdsapi.Client()</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>c.retrieve(</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>  <span class="st">'projections-cmip5-monthly-single-levels'</span>,</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>  {</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>    <span class="st">'ensemble_member'</span>: <span class="st">'r1i1p1'</span>,</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>    <span class="st">'format'</span>: <span class="st">'zip'</span>,</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>    <span class="st">'experiment'</span>: <span class="st">'historical'</span>,</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>    <span class="st">'variable'</span>: [</span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>      <span class="st">'10m_wind_speed'</span>,</span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>      <span class="st">'2m_temperature'</span>,</span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a>      <span class="st">'maximum_2m_temperature_in_the_last_24_hours'</span>,</span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a>      <span class="st">'minimum_2m_temperature_in_the_last_24_hours'</span>,</span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a>      <span class="st">'near_surface_relative_humidity'</span>,</span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a>      <span class="st">'surface_pressure'</span>,</span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a>      <span class="st">'total_cloud_cover'</span>,</span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a>      <span class="st">'mean_precipitation_flux'</span>, </span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a>    ],</span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a>    <span class="st">'model'</span>: <span class="st">'csiro_mk3_6_0'</span>,</span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a>    <span class="st">'period'</span>: <span class="st">'185001-200512'</span>,</span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a>  },</span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a>  <span class="st">'CSIRO-Mk3-6-0_historical.zip'</span>)</span></code></pre></div>
</div>
<div class="tab-pane" id="ipsl-cm5a-mr" role="tabpanel" aria-labelledby="ipsl-cm5a-mr-tab">

<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="im">import</span> cdsapi</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>c <span class="op">=</span> cdsapi.Client()</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>c.retrieve(</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>  <span class="st">'projections-cmip5-monthly-single-levels'</span>,</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>  {</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>    <span class="st">'ensemble_member'</span>: <span class="st">'r1i1p1'</span>,</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>    <span class="st">'format'</span>: <span class="st">'zip'</span>,</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>    <span class="st">'experiment'</span>: <span class="st">'historical'</span>,</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>    <span class="st">'variable'</span>: [</span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a>      <span class="st">'10m_wind_speed'</span>,</span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>      <span class="st">'2m_temperature'</span>,</span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>      <span class="st">'maximum_2m_temperature_in_the_last_24_hours'</span>,</span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>      <span class="st">'minimum_2m_temperature_in_the_last_24_hours'</span>, </span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>      <span class="st">'near_surface_relative_humidity'</span>,</span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a>      <span class="st">'surface_pressure'</span>,</span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a>      <span class="st">'total_cloud_cover'</span>,</span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a>      <span class="st">'mean_precipitation_flux'</span>, </span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a>    ],</span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a>    <span class="st">'model'</span>: <span class="st">'ipsl_cm5a_mr'</span>,</span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a>    <span class="st">'period'</span>: <span class="st">'185001-200512'</span>,</span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a>  },</span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a>  <span class="st">'IPSL-CM5A-MR_historical.zip'</span>)</span></code></pre></div>
</div>
</div>
</div>
<div class="section level4 tabset tabset-pills">
<h4 class="tabset tabset-pills" id="future-projections">Future projections<a class="anchor" aria-label="anchor" href="#future-projections"></a>
</h4>
<p>Select a General Circulation Model</p>



<ul class="nav nav-pills" id="future-projections" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#cesm1_cam5-1" id="cesm1_cam5-1-tab" type="button" role="tab" aria-controls="cesm1_cam5-1" aria-selected="true" class="active nav-link">CESM1_CAM5</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#csiro-mk3-6-0-1" id="csiro-mk3-6-0-1-tab" type="button" role="tab" aria-controls="csiro-mk3-6-0-1" aria-selected="false" class="nav-link">CSIRO-Mk3-6-0</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#ipsl-cm5a-mr-1" id="ipsl-cm5a-mr-1-tab" type="button" role="tab" aria-controls="ipsl-cm5a-mr-1" aria-selected="false" class="nav-link">IPSL-CM5A-MR</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="cesm1_cam5-1" role="tabpanel" aria-labelledby="cesm1_cam5-1-tab">

<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="im">import</span> cdsapi</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>c <span class="op">=</span> cdsapi.Client()</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>c.retrieve(</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>  <span class="st">'projections-cmip5-monthly-single-levels'</span>,</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>  {</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>    <span class="st">'ensemble_member'</span>: <span class="st">'r1i1p1'</span>,</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>    <span class="st">'format'</span>: <span class="st">'zip'</span>,</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>    <span class="st">'experiment'</span>: <span class="st">'rcp_2_6'</span>,</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>    <span class="st">'variable'</span>: [</span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>      <span class="st">'10m_wind_speed'</span>,</span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>      <span class="st">'2m_temperature'</span>,</span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>      <span class="st">'maximum_2m_temperature_in_the_last_24_hours'</span>,</span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a>      <span class="st">'minimum_2m_temperature_in_the_last_24_hours'</span>,</span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a>      <span class="st">'near_surface_relative_humidity'</span>,</span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a>      <span class="st">'surface_pressure'</span>,</span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a>      <span class="st">'total_cloud_cover'</span>,</span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a>      <span class="st">'mean_precipitation_flux'</span>, </span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a>      ],</span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a>    <span class="st">'model'</span>: <span class="st">'cesm1_cam5'</span>,</span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a>    <span class="st">'period'</span>: <span class="st">'200601-210012'</span>,</span>
<span id="cb28-23"><a href="#cb28-23" tabindex="-1"></a>  },</span>
<span id="cb28-24"><a href="#cb28-24" tabindex="-1"></a>  <span class="st">'CESM1-CAM5_RCP_2_6.zip'</span>)</span></code></pre></div>
</div>
<div class="tab-pane" id="csiro-mk3-6-0-1" role="tabpanel" aria-labelledby="csiro-mk3-6-0-1-tab">

<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="im">import</span> cdsapi</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>c <span class="op">=</span> cdsapi.Client()</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>c.retrieve(</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>  <span class="st">'projections-cmip5-monthly-single-levels'</span>,</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>  {</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>    <span class="st">'ensemble_member'</span>: <span class="st">'r1i1p1'</span>,</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>    <span class="st">'format'</span>: <span class="st">'zip'</span>,</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>    <span class="st">'experiment'</span>: <span class="st">'rcp_2_6'</span>,</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>    <span class="st">'variable'</span>: [</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>      <span class="st">'10m_wind_speed'</span>,</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>      <span class="st">'2m_temperature'</span>,</span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>      <span class="st">'maximum_2m_temperature_in_the_last_24_hours'</span>,</span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>      <span class="st">'minimum_2m_temperature_in_the_last_24_hours'</span>,</span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a>      <span class="st">'near_surface_relative_humidity'</span>,</span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a>      <span class="st">'surface_pressure'</span>,</span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a>      <span class="st">'total_cloud_cover'</span>,</span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a>      <span class="st">'mean_precipitation_flux'</span>, </span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a>    ],</span>
<span id="cb29-21"><a href="#cb29-21" tabindex="-1"></a>    <span class="st">'model'</span>: <span class="st">'csiro_mk3_6_0'</span>,</span>
<span id="cb29-22"><a href="#cb29-22" tabindex="-1"></a>    <span class="st">'period'</span>: <span class="st">'200601-210012'</span>,</span>
<span id="cb29-23"><a href="#cb29-23" tabindex="-1"></a>  },</span>
<span id="cb29-24"><a href="#cb29-24" tabindex="-1"></a>  <span class="st">'CSIRO-Mk3-6-0_RCP_2_6.zip'</span>)</span></code></pre></div>
</div>
<div class="tab-pane" id="ipsl-cm5a-mr-1" role="tabpanel" aria-labelledby="ipsl-cm5a-mr-1-tab">

<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="im">import</span> cdsapi</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>c <span class="op">=</span> cdsapi.Client()</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>c.retrieve(</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  <span class="st">'projections-cmip5-monthly-single-levels'</span>,</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>  {</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>    <span class="st">'ensemble_member'</span>: <span class="st">'r1i1p1'</span>,</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>    <span class="st">'format'</span>: <span class="st">'zip'</span>,</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>    <span class="st">'experiment'</span>: <span class="st">'rcp_2_6'</span>,</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>    <span class="st">'variable'</span>: [</span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>      <span class="st">'10m_wind_speed'</span>,</span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>      <span class="st">'2m_temperature'</span>,</span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a>      <span class="st">'maximum_2m_temperature_in_the_last_24_hours'</span>,</span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>      <span class="st">'minimum_2m_temperature_in_the_last_24_hours'</span>, </span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a>      <span class="st">'near_surface_relative_humidity'</span>,</span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a>      <span class="st">'surface_pressure'</span>,</span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a>      <span class="st">'total_cloud_cover'</span>,</span>
<span id="cb30-19"><a href="#cb30-19" tabindex="-1"></a>      <span class="st">'mean_precipitation_flux'</span>, </span>
<span id="cb30-20"><a href="#cb30-20" tabindex="-1"></a>    ],</span>
<span id="cb30-21"><a href="#cb30-21" tabindex="-1"></a>    <span class="st">'model'</span>: <span class="st">'ipsl_cm5a_mr'</span>,</span>
<span id="cb30-22"><a href="#cb30-22" tabindex="-1"></a>    <span class="st">'period'</span>: <span class="st">'200601-210012'</span>,</span>
<span id="cb30-23"><a href="#cb30-23" tabindex="-1"></a>  },</span>
<span id="cb30-24"><a href="#cb30-24" tabindex="-1"></a>  <span class="st">'IPSL-CM5A-MR_RCP_2_6.zip'</span>)</span></code></pre></div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="section"></h4>
<div class="alert alert-primary" role="alert">
For saving space in this vignette, we only report the code to download
data from one of the four RCPs. If a user desire to download the rest of
the RCPs, just need to change the code above, indicating any other RCPs
code (_4_5, _6_0, _8_5) where they now specify _2_6
</div>
</div>
</div>
<div class="section level3">
<h3 id="create-dictionary-2">Create dictionary<a class="anchor" aria-label="anchor" href="#create-dictionary-2"></a>
</h3>
<p>Before importing the data in an R session, we need to define a
dictionary to standarize units of variables to the <a href="https://github.com/SantanderMetGroup/climate4R" class="external-link">climate4R</a>
vocabulary (check <code><a href="https://rdrr.io/pkg/climate4R.UDG/man/C4R.vocabulary.html" class="external-link">climate4R.UDG::C4R.vocabulary()</a></code>).</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.create</a></span><span class="op">(</span><span class="st">"Data/CMIP5/CMIP5_dictionary.dic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"identifier,short_name,time_step,lower_time_bound,upper_time_bound,cell_method,offset,scale,deaccum,derived,interface"</span>,</span>
<span>  <span class="st">"tasmax,tasmax,1mo,0,12,max,-273.15,1,0,0,"</span>,</span>
<span>  <span class="st">"tasmin,tasmin,1mo,0,12,min,-273.15,1,0,0,"</span>,</span>
<span>  <span class="st">"tas,tas,1mo,0,12,mean,-273.15,1,0,0,"</span>,</span>
<span>  <span class="st">"pr,pr,1mo,0,12,mean,0,2592000,0,0,"</span>,</span>
<span>  <span class="st">"hurs,hurs,1mo,0,12,mean,0,1,0,0,"</span>,</span>
<span>  <span class="st">"cld,clt,1mo,0,12,mean,0,1,0,0,"</span>,</span>
<span>  <span class="st">"ps,ps,1mo,0,12,mean,0,1,0,0,"</span>,</span>
<span>  <span class="st">"wss,sfcWind,1mo,0,12,mean,0,1,0,0,"</span></span>
<span><span class="op">)</span>, <span class="st">"Data/CMIP5/CMIP5_dictionary.dic"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Diego Nieto-Lugilde, Daniel Romera-Romera.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
